<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>pandas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-0508618caa1d256af916c83e0797e277.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./matplotlib.html">数据分析</a></li><li class="breadcrumb-item"><a href="./pandas.html">Pandas及应用</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">基于Python的经济数据分析与应用</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/YuMingchaonjnu/Economic-Analysis" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">前言</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Python基础</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">引言</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python基础</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numpy 基础</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">数据分析</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matplotlib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">数据的可视化</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pandas.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Pandas及应用</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">数据的统计描述</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">回归分析</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">线性回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">逻辑回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lasso.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lasso回归</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">总结</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">参考文献</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul class="collapse">
  <li><a href="#载入数据" id="toc-载入数据" class="nav-link active" data-scroll-target="#载入数据">载入数据</a></li>
  <li><a href="#pandas的基本操作" id="toc-pandas的基本操作" class="nav-link" data-scroll-target="#pandas的基本操作">Pandas的基本操作</a></li>
  <li><a href="#apply-方法" id="toc-apply-方法" class="nav-link" data-scroll-target="#apply-方法">apply 方法</a></li>
  <li><a href="#检测和处理缺失值" id="toc-检测和处理缺失值" class="nav-link" data-scroll-target="#检测和处理缺失值">检测和处理缺失值</a></li>
  <li><a href="#异常值" id="toc-异常值" class="nav-link" data-scroll-target="#异常值">异常值</a></li>
  <li><a href="#观测值排序" id="toc-观测值排序" class="nav-link" data-scroll-target="#观测值排序">观测值排序</a></li>
  <li><a href="#数据集合并" id="toc-数据集合并" class="nav-link" data-scroll-target="#数据集合并">数据集合并</a></li>
  <li><a href="#多级索引" id="toc-多级索引" class="nav-link" data-scroll-target="#多级索引">多级索引</a></li>
  <li><a href="#pandas中的分组计算groupby" id="toc-pandas中的分组计算groupby" class="nav-link" data-scroll-target="#pandas中的分组计算groupby">Pandas中的分组计算（<code>groupby</code>）</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="pandas.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./matplotlib.html">数据分析</a></li><li class="breadcrumb-item"><a href="./pandas.html">Pandas及应用</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Pandas 基础应用</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Pandas是数据分析最常用的包，从基本的数据处理到更复杂的统计功能，如 statsmodels 和 scikit-learn库，都是建立在pandas基础上的。</p>
<p>这一部分应用<a href="https://www.rug.nl/ggdc/productivity/pwt/">Penn World Table</a>介绍应用Pandas处理原始数据的一些常用方法。该数据集当前版本为PWT 10.01，包含183个国家1950-2019年的收入、产出、投入和生产率等指标，详细介绍可参见<a href="https://www.rug.nl/ggdc/docs/pwt100-user-guide-to-data-files.pdf">User Guide to PWT 10.0 data files</a>。数据背后的方法、理论及使用建议，可参见 <span class="citation" data-cites="feenstra2015next">Feenstra, Inklaar, and Timmer (<a href="#ref-feenstra2015next" role="doc-biblioref">2015</a>)</span>。</p>
<p>同样，在进行进一步操作之前，先载入必要的库：</p>
<div id="a9c33386" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">"figure.figsize"</span>] <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">6</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> wbgapi <span class="im">as</span> wb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="载入数据" class="level2">
<h2 class="anchored" data-anchor-id="载入数据">载入数据</h2>
<section id="创建dataframe" class="level3">
<h3 class="anchored" data-anchor-id="创建dataframe">创建DataFrame</h3>
<p>可以由数组、列表、字典、序列等创建数据框。例如，使用Numpy生成两列服从正态分布的随机数：</p>
<div id="5a52001d" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">1</span>, scale<span class="op">=</span><span class="dv">2</span>, size<span class="op">=</span>(<span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>X,             </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>             columns<span class="op">=</span>[<span class="st">'X1'</span>, <span class="st">'X2'</span>])</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">X1</th>
<th data-quarto-table-cell-role="th">X2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.432709</td>
<td>-1.118539</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>5.984532</td>
<td>2.330193</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-2.847196</td>
<td>-0.474233</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-1.882047</td>
<td>-2.059043</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.694892</td>
<td>1.284894</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>下面来看字典的例子。定义字典常采用两种方式:</p>
<ul>
<li><strong>面向列的字典</strong>，字典的键代表表格的列名，而每个值是一个包含该列所有数据的列表。当使用 <code>pd.DataFrame(data)</code> 创建 DataFrame 时，会直接将这些键作为列名，值作为列数据：</li>
</ul>
<div id="a8168ecd" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'地区'</span>: [<span class="st">'江苏省'</span>, <span class="st">'浙江省'</span>, <span class="st">'上海市'</span>],</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'人口（万人）'</span>: [<span class="dv">8526</span>, <span class="dv">6627</span>, <span class="dv">2487</span>],</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'人均国内生产总值（元）'</span>: [<span class="dv">150487</span>, <span class="dv">125043</span>, <span class="dv">19032</span>]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">地区</th>
<th data-quarto-table-cell-role="th">人口（万人）</th>
<th data-quarto-table-cell-role="th">人均国内生产总值（元）</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>江苏省</td>
<td>8526</td>
<td>150487</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>浙江省</td>
<td>6627</td>
<td>125043</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>上海市</td>
<td>2487</td>
<td>19032</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>面向行的字典，将每一行数据定义为一个独立的字典，然后将这些字典放入一个列表中。每个字典的键是列名，值是该行对应的数据。</li>
</ul>
<div id="555eb4c3" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'地区'</span>: <span class="st">'江苏省'</span>, <span class="st">'人口（万人）'</span>: <span class="dv">8526</span>, <span class="st">'人均国内生产总值（元）'</span>: <span class="dv">150487</span>},</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'地区'</span>: <span class="st">'浙江省'</span>, <span class="st">'人口（万人）'</span>: <span class="dv">6627</span>, <span class="st">'人均国内生产总值（元）'</span>: <span class="dv">125043</span>},</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'地区'</span>: <span class="st">'上海市'</span>, <span class="st">'人口（万人）'</span>: <span class="dv">2487</span>, <span class="st">'人均国内生产总值（元）'</span>: <span class="dv">19032</span>}</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">地区</th>
<th data-quarto-table-cell-role="th">人口（万人）</th>
<th data-quarto-table-cell-role="th">人均国内生产总值（元）</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>江苏省</td>
<td>8526</td>
<td>150487</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>浙江省</td>
<td>6627</td>
<td>125043</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>上海市</td>
<td>2487</td>
<td>19032</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="sec-reading_data" class="level3">
<h3 class="anchored" data-anchor-id="sec-reading_data">读取数据</h3>
<p>Pandas提供了广泛的导入数据的命令，当前主要软件存储格式的文件，csv, excel, stata, html, json,sql等，几乎都可以识别。 网站提供了Stata和Excel格式数据，假设数据保存在当前路径的datasets子文件中。Excel格式数据使用<code>pd.read_excel()</code>函数读取数据，有多个表单需要用参数<code>sheet_name</code>指明表单名称：</p>
<div id="3b6a1308" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pwt <span class="op">=</span> pd.read_excel(io <span class="op">=</span> <span class="st">"datasets/pwt1001.xlsx"</span>,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                header<span class="op">=</span><span class="dv">0</span>,                </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                sheet_name<span class="op">=</span><span class="st">"Data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>注意其中的几个参数，<code>io</code>是文件路径；<code>header</code>表明列标题行，这里是第一行；<code>sheet_name</code>是数据所在表单名；将载入的数据赋值给pwt数据框。</p>
<p>如果下载了Stata格式，使用<code>pd.read_stata()</code>函数读取数据：</p>
<div id="cd077ade" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pwt <span class="op">=</span> pd.read_stata(filepath_or_buffer<span class="op">=</span><span class="st">"datasets/pwt1001.dta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pandas中的Series 基于Numpy数组，支持许多类似运算，可以看作一“列”数据；</p>
<div id="768af6b4" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>pop <span class="op">=</span> pwt[<span class="st">'pop'</span>]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>pandas.core.series.Series</code></pre>
</div>
</div>
<p>序列与Numpy数组一样有许多方法运算，读者可以参阅<a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html">pandas.Series</a>。数据处理中主要对象是DataFrame，类似Excel表单每一列对应一个变量。索引（index）对应行，变量列名（columns）对应列。</p>
<p>Penn World Table 数据本身是一个面板数据（Panel Data），“国家 - 年” 唯一识别一个观测值。我们从截面数据入手先只保留2019年数据，然后再看多索引的情况。这里<code>.copy()</code>拷贝了原数据生成一个新的数据框，这样即使改变数据也不影响初始的数据框。另外，变量<code>cor_exp</code>在2019年全部为缺失值，这里直接删除了。</p>
<div id="2a8ae386" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pwt2019 <span class="op">=</span> pwt[pwt[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">2019</span>].copy().drop(labels<span class="op">=</span><span class="st">'cor_exp'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="pandas的基本操作" class="level2">
<h2 class="anchored" data-anchor-id="pandas的基本操作">Pandas的基本操作</h2>
<section id="设置索引" class="level3">
<h3 class="anchored" data-anchor-id="设置索引">设置索引</h3>
<p>先为<code>pwt2019</code>数据框设置索引(index)变量，这里使用国家名代码变量（countrycode），<code>inplace=True</code>选项原地改变数据框，不需要另外赋值：</p>
<div id="248f4e3b" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>pwt2019.set_index(<span class="st">'countrycode'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="概览数据" class="level3">
<h3 class="anchored" data-anchor-id="概览数据">概览数据</h3>
<p>可以<code>df.info()</code>概率数据集，或者使用<code>df.head()</code>或<code>df.tail()</code>查看头部和尾部观测值：</p>
<div id="44445f14" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pwt2019.info()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>pwt2019.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 183 entries, ABW to ZWE
Data columns (total 50 columns):
 #   Column         Non-Null Count  Dtype   
---  ------         --------------  -----   
 0   country        183 non-null    object  
 1   currency_unit  183 non-null    object  
 2   year           183 non-null    int16   
 3   rgdpe          183 non-null    float32 
 4   rgdpo          183 non-null    float32 
 5   pop            183 non-null    float64 
 6   emp            177 non-null    float32 
 7   avh            66 non-null     float64 
 8   hc             145 non-null    float32 
 9   ccon           183 non-null    float32 
 10  cda            183 non-null    float32 
 11  cgdpe          183 non-null    float32 
 12  cgdpo          183 non-null    float32 
 13  cn             180 non-null    float32 
 14  ck             137 non-null    float32 
 15  ctfp           118 non-null    float32 
 16  cwtfp          118 non-null    float32 
 17  rgdpna         183 non-null    float32 
 18  rconna         183 non-null    float32 
 19  rdana          183 non-null    float32 
 20  rnna           180 non-null    float32 
 21  rkna           137 non-null    float32 
 22  rtfpna         118 non-null    float32 
 23  rwtfpna        118 non-null    float32 
 24  labsh          138 non-null    float32 
 25  irr            137 non-null    float32 
 26  delta          180 non-null    float32 
 27  xr             183 non-null    float64 
 28  pl_con         183 non-null    float32 
 29  pl_da          183 non-null    float32 
 30  pl_gdpo        183 non-null    float32 
 31  i_cig          183 non-null    category
 32  i_xm           183 non-null    category
 33  i_xr           183 non-null    category
 34  i_outlier      183 non-null    category
 35  i_irr          137 non-null    category
 36  statcap        127 non-null    float64 
 37  csh_c          183 non-null    float32 
 38  csh_i          183 non-null    float32 
 39  csh_g          183 non-null    float32 
 40  csh_x          183 non-null    float32 
 41  csh_m          183 non-null    float32 
 42  csh_r          183 non-null    float32 
 43  pl_c           183 non-null    float32 
 44  pl_i           183 non-null    float32 
 45  pl_g           183 non-null    float32 
 46  pl_x           183 non-null    float32 
 47  pl_m           183 non-null    float32 
 48  pl_n           180 non-null    float32 
 49  pl_k           137 non-null    float32 
dtypes: category(5), float32(38), float64(4), int16(1), object(2)
memory usage: 39.2+ KB</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ABW</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>2019</td>
<td>3921.261230</td>
<td>3467.299561</td>
<td>0.106314</td>
<td>0.047601</td>
<td>NaN</td>
<td>NaN</td>
<td>3023.694824</td>
<td>...</td>
<td>0.973115</td>
<td>-1.091808</td>
<td>2.125691e-07</td>
<td>0.883092</td>
<td>0.815759</td>
<td>0.744329</td>
<td>0.707260</td>
<td>0.622660</td>
<td>0.805100</td>
<td>0.648114</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGO</td>
<td>Angola</td>
<td>Kwanza</td>
<td>2019</td>
<td>228151.015625</td>
<td>227855.718750</td>
<td>31.825295</td>
<td>16.644962</td>
<td>NaN</td>
<td>1.481984</td>
<td>155943.718750</td>
<td>...</td>
<td>0.344351</td>
<td>-0.113983</td>
<td>-1.204703e-01</td>
<td>0.438169</td>
<td>0.342872</td>
<td>0.240024</td>
<td>0.476486</td>
<td>0.611627</td>
<td>0.211084</td>
<td>0.396034</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AIA</td>
<td>Anguilla</td>
<td>East Caribbean Dollar</td>
<td>2019</td>
<td>376.634979</td>
<td>225.680527</td>
<td>0.014869</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>438.470032</td>
<td>...</td>
<td>1.480300</td>
<td>-2.445801</td>
<td>-1.433542e-01</td>
<td>1.064513</td>
<td>1.029199</td>
<td>0.732212</td>
<td>0.768944</td>
<td>0.602734</td>
<td>0.897989</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ALB</td>
<td>Albania</td>
<td>Lek</td>
<td>2019</td>
<td>35890.019531</td>
<td>36103.042969</td>
<td>2.880917</td>
<td>1.075898</td>
<td>NaN</td>
<td>2.964992</td>
<td>33399.167969</td>
<td>...</td>
<td>0.126594</td>
<td>-0.313949</td>
<td>6.114468e-02</td>
<td>0.473077</td>
<td>0.456882</td>
<td>0.235589</td>
<td>0.629832</td>
<td>0.525463</td>
<td>0.300975</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ARE</td>
<td>United Arab Emirates</td>
<td>UAE Dirham</td>
<td>2019</td>
<td>681525.812500</td>
<td>645956.250000</td>
<td>9.770529</td>
<td>5.808834</td>
<td>NaN</td>
<td>2.746695</td>
<td>306771.156250</td>
<td>...</td>
<td>0.889652</td>
<td>-0.701231</td>
<td>-4.849206e-07</td>
<td>0.725061</td>
<td>0.480580</td>
<td>0.692488</td>
<td>0.688882</td>
<td>0.647336</td>
<td>0.270424</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>5 rows × 50 columns</p>
</div>
</div>
</div>
<p>默认显示5条观测值，如果希望看到更多观测值，可以使用 <code>df.tail(n=10)</code> 修改数值。</p>
<p>可以应用<code>.shape, .ndim</code>,<code>.columns</code>等属性查看基本信息，可以看到数据集包含51个变量共183个观测值。</p>
<div id="e4e76c54" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pwt2019.shape)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pwt2019.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(183, 50)
Index(['country', 'currency_unit', 'year', 'rgdpe', 'rgdpo', 'pop', 'emp',
       'avh', 'hc', 'ccon', 'cda', 'cgdpe', 'cgdpo', 'cn', 'ck', 'ctfp',
       'cwtfp', 'rgdpna', 'rconna', 'rdana', 'rnna', 'rkna', 'rtfpna',
       'rwtfpna', 'labsh', 'irr', 'delta', 'xr', 'pl_con', 'pl_da', 'pl_gdpo',
       'i_cig', 'i_xm', 'i_xr', 'i_outlier', 'i_irr', 'statcap', 'csh_c',
       'csh_i', 'csh_g', 'csh_x', 'csh_m', 'csh_r', 'pl_c', 'pl_i', 'pl_g',
       'pl_x', 'pl_m', 'pl_n', 'pl_k'],
      dtype='object')</code></pre>
</div>
</div>
<p><code>df.describe()</code>函数报告数值型变量基本的描述统计量，如观测值数、最小/大值等：</p>
<div id="e9bedcc6" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pwt2019.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">cda</th>
<th data-quarto-table-cell-role="th">cgdpe</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>183.0</td>
<td>1.830000e+02</td>
<td>1.830000e+02</td>
<td>183.000000</td>
<td>177.000000</td>
<td>66.000000</td>
<td>145.000000</td>
<td>1.830000e+02</td>
<td>1.830000e+02</td>
<td>1.830000e+02</td>
<td>...</td>
<td>183.000000</td>
<td>183.000000</td>
<td>183.000000</td>
<td>183.000000</td>
<td>183.000000</td>
<td>183.000000</td>
<td>183.000000</td>
<td>183.000000</td>
<td>180.000000</td>
<td>137.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>2019.0</td>
<td>6.856771e+05</td>
<td>6.845371e+05</td>
<td>41.425665</td>
<td>18.736708</td>
<td>1849.981084</td>
<td>2.709271</td>
<td>4.942579e+05</td>
<td>6.783440e+05</td>
<td>6.832245e+05</td>
<td>...</td>
<td>0.289549</td>
<td>-0.395140</td>
<td>0.047751</td>
<td>0.682804</td>
<td>0.806373</td>
<td>0.593989</td>
<td>0.647064</td>
<td>0.608261</td>
<td>0.563515</td>
<td>0.835093</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.0</td>
<td>2.326857e+06</td>
<td>2.326577e+06</td>
<td>150.991398</td>
<td>72.598854</td>
<td>269.239240</td>
<td>0.702803</td>
<td>1.622457e+06</td>
<td>2.332140e+06</td>
<td>2.315811e+06</td>
<td>...</td>
<td>0.318229</td>
<td>0.352245</td>
<td>0.132470</td>
<td>1.324540</td>
<td>2.508052</td>
<td>1.060947</td>
<td>0.072499</td>
<td>0.060341</td>
<td>1.523753</td>
<td>1.048638</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>2019.0</td>
<td>9.919158e+01</td>
<td>7.769418e+01</td>
<td>0.004989</td>
<td>0.002537</td>
<td>1380.607643</td>
<td>1.224987</td>
<td>1.432163e+02</td>
<td>1.593778e+02</td>
<td>9.965278e+01</td>
<td>...</td>
<td>0.000002</td>
<td>-2.445801</td>
<td>-0.402837</td>
<td>0.164474</td>
<td>0.238807</td>
<td>0.048096</td>
<td>0.410998</td>
<td>0.430082</td>
<td>0.102959</td>
<td>0.157861</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>2019.0</td>
<td>2.542229e+04</td>
<td>2.496249e+04</td>
<td>2.148923</td>
<td>0.966091</td>
<td>1650.921776</td>
<td>2.157010</td>
<td>2.015232e+04</td>
<td>2.440136e+04</td>
<td>2.538902e+04</td>
<td>...</td>
<td>0.089786</td>
<td>-0.500661</td>
<td>-0.004248</td>
<td>0.386795</td>
<td>0.496182</td>
<td>0.301914</td>
<td>0.611683</td>
<td>0.569492</td>
<td>0.315582</td>
<td>0.509706</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>2019.0</td>
<td>8.906167e+04</td>
<td>8.964218e+04</td>
<td>8.955102</td>
<td>4.235073</td>
<td>1818.281597</td>
<td>2.776406</td>
<td>7.898192e+04</td>
<td>9.572196e+04</td>
<td>8.879797e+04</td>
<td>...</td>
<td>0.192402</td>
<td>-0.299031</td>
<td>0.010712</td>
<td>0.494755</td>
<td>0.573736</td>
<td>0.440775</td>
<td>0.658543</td>
<td>0.602733</td>
<td>0.396131</td>
<td>0.657925</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>2019.0</td>
<td>4.438705e+05</td>
<td>4.277259e+05</td>
<td>29.763979</td>
<td>11.694400</td>
<td>2061.049973</td>
<td>3.259456</td>
<td>3.095488e+05</td>
<td>4.139670e+05</td>
<td>4.424204e+05</td>
<td>...</td>
<td>0.358440</td>
<td>-0.170650</td>
<td>0.073669</td>
<td>0.733338</td>
<td>0.729491</td>
<td>0.662306</td>
<td>0.688106</td>
<td>0.645397</td>
<td>0.529977</td>
<td>0.850074</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>2019.0</td>
<td>2.086051e+07</td>
<td>2.059584e+07</td>
<td>1433.783686</td>
<td>798.807739</td>
<td>2474.911893</td>
<td>4.351568</td>
<td>1.682624e+07</td>
<td>2.138355e+07</td>
<td>2.079136e+07</td>
<td>...</td>
<td>2.194109</td>
<td>-0.001072</td>
<td>0.704883</td>
<td>18.143538</td>
<td>34.444988</td>
<td>14.175777</td>
<td>0.882256</td>
<td>0.847409</td>
<td>20.694918</td>
<td>12.002436</td>
</tr>
</tbody>
</table>

<p>8 rows × 43 columns</p>
</div>
</div>
</div>
</section>
<section id="选择观测值和变量" class="level3">
<h3 class="anchored" data-anchor-id="选择观测值和变量">选择观测值和变量</h3>
<p>应用中经常需要对某些观测值或特定子样本进行操作，就需要选择观测值和变量。</p>
<p>选择特定的<strong>行</strong>，在Python中最基本的方法是采用数组切片（slicing）方式。例如，选择第3至5个观测值，注意索引对应的是<code>[2:5]</code>：</p>
<div id="fe11e27a" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pwt2019[<span class="dv">2</span>:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">AIA</td>
<td>Anguilla</td>
<td>East Caribbean Dollar</td>
<td>2019</td>
<td>376.634979</td>
<td>225.680527</td>
<td>0.014869</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>438.470032</td>
<td>...</td>
<td>1.480300</td>
<td>-2.445801</td>
<td>-1.433542e-01</td>
<td>1.064513</td>
<td>1.029199</td>
<td>0.732212</td>
<td>0.768944</td>
<td>0.602734</td>
<td>0.897989</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ALB</td>
<td>Albania</td>
<td>Lek</td>
<td>2019</td>
<td>35890.019531</td>
<td>36103.042969</td>
<td>2.880917</td>
<td>1.075898</td>
<td>NaN</td>
<td>2.964992</td>
<td>33399.167969</td>
<td>...</td>
<td>0.126594</td>
<td>-0.313949</td>
<td>6.114468e-02</td>
<td>0.473077</td>
<td>0.456882</td>
<td>0.235589</td>
<td>0.629832</td>
<td>0.525463</td>
<td>0.300975</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ARE</td>
<td>United Arab Emirates</td>
<td>UAE Dirham</td>
<td>2019</td>
<td>681525.812500</td>
<td>645956.250000</td>
<td>9.770529</td>
<td>5.808834</td>
<td>NaN</td>
<td>2.746695</td>
<td>306771.156250</td>
<td>...</td>
<td>0.889652</td>
<td>-0.701231</td>
<td>-4.849206e-07</td>
<td>0.725061</td>
<td>0.480580</td>
<td>0.692488</td>
<td>0.688882</td>
<td>0.647336</td>
<td>0.270424</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>3 rows × 50 columns</p>
</div>
</div>
</div>
<p>要选择<strong>列</strong>，可以用包含列名字的列表指定：</p>
<div id="07b2d1a6" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>vars_selected <span class="op">=</span> [<span class="st">'country'</span>, <span class="st">'rgdpe'</span>, <span class="st">'rgdpo'</span>, <span class="st">'pop'</span>, <span class="st">'emp'</span>, <span class="st">'cgdpe'</span>, <span class="st">'cgdpo'</span>, <span class="st">'ctfp'</span> ]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>pwt2019_sub <span class="op">=</span> pwt2019[vars_selected]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>pwt2019_sub.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">cgdpe</th>
<th data-quarto-table-cell-role="th">cgdpo</th>
<th data-quarto-table-cell-role="th">ctfp</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ABW</td>
<td>Aruba</td>
<td>3921.261230</td>
<td>3467.299561</td>
<td>0.106314</td>
<td>0.047601</td>
<td>3912.334717</td>
<td>3466.241943</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGO</td>
<td>Angola</td>
<td>228151.015625</td>
<td>227855.718750</td>
<td>31.825295</td>
<td>16.644962</td>
<td>227771.609375</td>
<td>223289.312500</td>
<td>0.387996</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AIA</td>
<td>Anguilla</td>
<td>376.634979</td>
<td>225.680527</td>
<td>0.014869</td>
<td>NaN</td>
<td>375.136444</td>
<td>241.384537</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ALB</td>
<td>Albania</td>
<td>35890.019531</td>
<td>36103.042969</td>
<td>2.880917</td>
<td>1.075898</td>
<td>35808.343750</td>
<td>36288.328125</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ARE</td>
<td>United Arab Emirates</td>
<td>681525.812500</td>
<td>645956.250000</td>
<td>9.770529</td>
<td>5.808834</td>
<td>678241.187500</td>
<td>635332.812500</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="loc方法" class="level3">
<h3 class="anchored" data-anchor-id="loc方法"><code>.loc</code>方法</h3>
<p><code>.loc</code> 是基于标签（label-based） 的数据选择方法。这意味着你使用行和列的实际标签名来选择数据，而不是它们的整数位置。</p>
<p>在之前我们将ISO国家代码设置位索引，因此选择列时可以用索引标签进行。例如，要选择金砖国家（BRICKS）的观测值：</p>
<div id="7be2d9e5" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>bricks <span class="op">=</span> [<span class="st">'CHN'</span>, <span class="st">'BRA'</span>, <span class="st">'RUS'</span>, <span class="st">'IND'</span>, <span class="st">'ZAF'</span>]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>pwt2019.loc[bricks]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">CHN</td>
<td>China</td>
<td>Yuan Renminbi</td>
<td>2019</td>
<td>20056066.0</td>
<td>2.025766e+07</td>
<td>1433.783686</td>
<td>798.807739</td>
<td>2168.918848</td>
<td>2.698987</td>
<td>1.056606e+07</td>
<td>...</td>
<td>0.192402</td>
<td>-0.167672</td>
<td>-4.100976e-03</td>
<td>0.716501</td>
<td>0.679048</td>
<td>0.865375</td>
<td>0.695068</td>
<td>0.734048</td>
<td>0.457278</td>
<td>0.598894</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">BRA</td>
<td>Brazil</td>
<td>Brazilian Real</td>
<td>2019</td>
<td>3089273.5</td>
<td>3.080048e+06</td>
<td>211.049527</td>
<td>93.956825</td>
<td>1707.795058</td>
<td>3.091373</td>
<td>2.566911e+06</td>
<td>...</td>
<td>0.132833</td>
<td>-0.137775</td>
<td>1.377994e-07</td>
<td>0.599450</td>
<td>0.528862</td>
<td>0.663023</td>
<td>0.646922</td>
<td>0.638165</td>
<td>0.355756</td>
<td>0.579635</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">RUS</td>
<td>Russian Federation</td>
<td>Russian Ruble</td>
<td>2019</td>
<td>4197222.5</td>
<td>4.161194e+06</td>
<td>145.872256</td>
<td>71.670639</td>
<td>1965.000000</td>
<td>3.434408</td>
<td>3.170826e+06</td>
<td>...</td>
<td>0.178951</td>
<td>-0.086548</td>
<td>-2.315040e-02</td>
<td>0.411263</td>
<td>0.573736</td>
<td>0.281037</td>
<td>0.576825</td>
<td>0.690811</td>
<td>0.466877</td>
<td>0.366449</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">IND</td>
<td>India</td>
<td>Indian Rupee</td>
<td>2019</td>
<td>8945547.0</td>
<td>9.170555e+06</td>
<td>1366.417754</td>
<td>497.615723</td>
<td>2122.940682</td>
<td>2.171165</td>
<td>6.608024e+06</td>
<td>...</td>
<td>0.051035</td>
<td>-0.077878</td>
<td>3.370060e-02</td>
<td>0.294905</td>
<td>0.356979</td>
<td>0.471800</td>
<td>0.692824</td>
<td>0.672622</td>
<td>0.210450</td>
<td>0.395132</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZAF</td>
<td>South Africa</td>
<td>Rand</td>
<td>2019</td>
<td>748940.0</td>
<td>7.340944e+05</td>
<td>58.558270</td>
<td>18.642710</td>
<td>2191.363362</td>
<td>2.908202</td>
<td>6.236696e+05</td>
<td>...</td>
<td>0.184207</td>
<td>-0.198112</td>
<td>4.914912e-03</td>
<td>0.463660</td>
<td>0.523813</td>
<td>0.447869</td>
<td>0.660216</td>
<td>0.604546</td>
<td>0.315006</td>
<td>0.525546</td>
</tr>
</tbody>
</table>

<p>5 rows × 50 columns</p>
</div>
</div>
</div>
<p>或者选择列指定列标签（名），效果与不使用<code>.loc()</code>只使用变量名效果一样。</p>
<div id="44c56fbe" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>variables <span class="op">=</span> [<span class="st">'country'</span>, <span class="st">'rgdpe'</span>, <span class="st">'pop'</span>]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>pwt2019.loc[:, variables]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">pop</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ABW</td>
<td>Aruba</td>
<td>3921.261230</td>
<td>0.106314</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGO</td>
<td>Angola</td>
<td>228151.015625</td>
<td>31.825295</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AIA</td>
<td>Anguilla</td>
<td>376.634979</td>
<td>0.014869</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ALB</td>
<td>Albania</td>
<td>35890.019531</td>
<td>2.880917</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ARE</td>
<td>United Arab Emirates</td>
<td>681525.812500</td>
<td>9.770529</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VNM</td>
<td>Viet Nam</td>
<td>750726.750000</td>
<td>96.462106</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">YEM</td>
<td>Yemen</td>
<td>50052.933594</td>
<td>29.161922</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZAF</td>
<td>South Africa</td>
<td>748940.000000</td>
<td>58.558270</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ZMB</td>
<td>Zambia</td>
<td>57956.183594</td>
<td>17.861030</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZWE</td>
<td>Zimbabwe</td>
<td>42296.062500</td>
<td>14.645468</td>
</tr>
</tbody>
</table>

<p>183 rows × 3 columns</p>
</div>
</div>
</div>
<p>或者同时指定行和列：</p>
<div id="7ccc7dbd" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>pwt2019.loc[bricks, variables]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">pop</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">CHN</td>
<td>China</td>
<td>20056066.0</td>
<td>1433.783686</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">BRA</td>
<td>Brazil</td>
<td>3089273.5</td>
<td>211.049527</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">RUS</td>
<td>Russian Federation</td>
<td>4197222.5</td>
<td>145.872256</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">IND</td>
<td>India</td>
<td>8945547.0</td>
<td>1366.417754</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZAF</td>
<td>South Africa</td>
<td>748940.0</td>
<td>58.558270</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>等价于</p>
<div id="c04e3d0d" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>pwt2019.loc[bricks][variables]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">pop</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">CHN</td>
<td>China</td>
<td>20056066.0</td>
<td>1433.783686</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">BRA</td>
<td>Brazil</td>
<td>3089273.5</td>
<td>211.049527</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">RUS</td>
<td>Russian Federation</td>
<td>4197222.5</td>
<td>145.872256</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">IND</td>
<td>India</td>
<td>8945547.0</td>
<td>1366.417754</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZAF</td>
<td>South Africa</td>
<td>748940.0</td>
<td>58.558270</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="iloc方法" class="level3">
<h3 class="anchored" data-anchor-id="iloc方法"><code>.iloc</code>方法</h3>
<p>相应的，<code>.iloc</code> 是使用行和列的整数位置（从 0 开始）来选择数据。这里需要注意Python中索引位置，进行切片（slicing）操作时，语法类似 <code>[start:end]</code>，要注意：</p>
<ul>
<li><code>start</code>：切片的起始索引，对应的元素会被包含。</li>
<li><code>end</code>：切片的结束索引，对应的元素不会被包含。例如：</li>
</ul>
<p>选择第2行数据（索引位置为1），结果得到一个序列:</p>
<div id="f8a250fc" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pwt2019.iloc[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>country                 Angola
currency_unit           Kwanza
year                      2019
rgdpe            228151.015625
rgdpo             227855.71875
pop                  31.825295
emp                  16.644962
avh                        NaN
hc                    1.481984
ccon              155943.71875
cda              198750.421875
cgdpe            227771.609375
cgdpo              223289.3125
cn                   1299231.5
ck                    0.016624
ctfp                  0.387996
cwtfp                 0.332153
rgdpna             222151.0625
rconna           155270.703125
rdana            198864.734375
rnna                 1300951.0
rkna                  1.005457
rtfpna                0.936524
rwtfpna               0.916698
labsh                 0.331142
irr                    0.11585
delta                 0.043606
xr                  364.825805
pl_con                0.381504
pl_da                 0.373184
pl_gdpo               0.380675
i_cig             Extrapolated
i_xm              Extrapolated
i_xr              Market-based
i_outlier              Regular
i_irr                  Regular
statcap                48.8889
csh_c                  0.49867
csh_i                  0.19171
csh_g                 0.199723
csh_x                 0.344351
csh_m                -0.113983
csh_r                 -0.12047
pl_c                  0.438169
pl_i                  0.342872
pl_g                  0.240024
pl_x                  0.476486
pl_m                  0.611627
pl_n                  0.211084
pl_k                  0.396034
Name: AGO, dtype: object</code></pre>
</div>
</div>
<p>选择第1行（索引为0）、第3行（索引为2）和第5行（索引为4）</p>
<div id="41ffaad4" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>pwt2019.iloc[[<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ABW</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>2019</td>
<td>3921.261230</td>
<td>3467.299561</td>
<td>0.106314</td>
<td>0.047601</td>
<td>NaN</td>
<td>NaN</td>
<td>3023.694824</td>
<td>...</td>
<td>0.973115</td>
<td>-1.091808</td>
<td>2.125691e-07</td>
<td>0.883092</td>
<td>0.815759</td>
<td>0.744329</td>
<td>0.707260</td>
<td>0.622660</td>
<td>0.805100</td>
<td>0.648114</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AIA</td>
<td>Anguilla</td>
<td>East Caribbean Dollar</td>
<td>2019</td>
<td>376.634979</td>
<td>225.680527</td>
<td>0.014869</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>438.470032</td>
<td>...</td>
<td>1.480300</td>
<td>-2.445801</td>
<td>-1.433542e-01</td>
<td>1.064513</td>
<td>1.029199</td>
<td>0.732212</td>
<td>0.768944</td>
<td>0.602734</td>
<td>0.897989</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ARE</td>
<td>United Arab Emirates</td>
<td>UAE Dirham</td>
<td>2019</td>
<td>681525.812500</td>
<td>645956.250000</td>
<td>9.770529</td>
<td>5.808834</td>
<td>NaN</td>
<td>2.746695</td>
<td>306771.156250</td>
<td>...</td>
<td>0.889652</td>
<td>-0.701231</td>
<td>-4.849206e-07</td>
<td>0.725061</td>
<td>0.480580</td>
<td>0.692488</td>
<td>0.688882</td>
<td>0.647336</td>
<td>0.270424</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>3 rows × 50 columns</p>
</div>
</div>
</div>
<p>选择前5行、第4至第6列观测值</p>
<div id="d41e9249" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>pwt2019.iloc[:<span class="dv">5</span>, <span class="dv">3</span>:<span class="dv">6</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ABW</td>
<td>3921.261230</td>
<td>3467.299561</td>
<td>0.106314</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGO</td>
<td>228151.015625</td>
<td>227855.718750</td>
<td>31.825295</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AIA</td>
<td>376.634979</td>
<td>225.680527</td>
<td>0.014869</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ALB</td>
<td>35890.019531</td>
<td>36103.042969</td>
<td>2.880917</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ARE</td>
<td>681525.812500</td>
<td>645956.250000</td>
<td>9.770529</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="根据条件筛选" class="level3">
<h3 class="anchored" data-anchor-id="根据条件筛选">根据条件筛选</h3>
<p>除了根据索引或位置选择数据外，也可以利用条件来筛选观测值。例如，根据人口变量（<code>pop</code>，单位：百万）选择2019年总人口超过2亿的观测值：</p>
<div id="a529bdb3" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pwt2019[pwt2019[<span class="st">'pop'</span>] <span class="op">&gt;=</span> <span class="dv">200</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">BRA</td>
<td>Brazil</td>
<td>Brazilian Real</td>
<td>2019</td>
<td>3.089274e+06</td>
<td>3.080048e+06</td>
<td>211.049527</td>
<td>93.956825</td>
<td>1707.795058</td>
<td>3.091373</td>
<td>2.566911e+06</td>
<td>...</td>
<td>0.132833</td>
<td>-0.137775</td>
<td>1.377994e-07</td>
<td>0.599450</td>
<td>0.528862</td>
<td>0.663023</td>
<td>0.646922</td>
<td>0.638165</td>
<td>0.355756</td>
<td>0.579635</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">CHN</td>
<td>China</td>
<td>Yuan Renminbi</td>
<td>2019</td>
<td>2.005607e+07</td>
<td>2.025766e+07</td>
<td>1433.783686</td>
<td>798.807739</td>
<td>2168.918848</td>
<td>2.698987</td>
<td>1.056606e+07</td>
<td>...</td>
<td>0.192402</td>
<td>-0.167672</td>
<td>-4.100976e-03</td>
<td>0.716501</td>
<td>0.679048</td>
<td>0.865375</td>
<td>0.695068</td>
<td>0.734048</td>
<td>0.457278</td>
<td>0.598894</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">IDN</td>
<td>Indonesia</td>
<td>Rupiah</td>
<td>2019</td>
<td>3.104439e+06</td>
<td>3.137931e+06</td>
<td>270.625568</td>
<td>131.170685</td>
<td>2019.923395</td>
<td>2.288165</td>
<td>2.051190e+06</td>
<td>...</td>
<td>0.089377</td>
<td>-0.081947</td>
<td>-1.223290e-03</td>
<td>0.377086</td>
<td>0.359957</td>
<td>0.295082</td>
<td>0.601248</td>
<td>0.669811</td>
<td>0.215823</td>
<td>0.387587</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">IND</td>
<td>India</td>
<td>Indian Rupee</td>
<td>2019</td>
<td>8.945547e+06</td>
<td>9.170555e+06</td>
<td>1366.417754</td>
<td>497.615723</td>
<td>2122.940682</td>
<td>2.171165</td>
<td>6.608024e+06</td>
<td>...</td>
<td>0.051035</td>
<td>-0.077878</td>
<td>3.370060e-02</td>
<td>0.294905</td>
<td>0.356979</td>
<td>0.471800</td>
<td>0.692824</td>
<td>0.672622</td>
<td>0.210450</td>
<td>0.395132</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">NGA</td>
<td>Nigeria</td>
<td>Naira</td>
<td>2019</td>
<td>9.834982e+05</td>
<td>1.001537e+06</td>
<td>200.963599</td>
<td>73.020554</td>
<td>NaN</td>
<td>1.974245</td>
<td>9.300954e+05</td>
<td>...</td>
<td>0.106134</td>
<td>-0.078965</td>
<td>-6.898887e-02</td>
<td>0.418511</td>
<td>1.166929</td>
<td>0.288400</td>
<td>0.507703</td>
<td>0.602859</td>
<td>0.788816</td>
<td>0.920094</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">PAK</td>
<td>Pakistan</td>
<td>Pakistan Rupee</td>
<td>2019</td>
<td>1.036800e+06</td>
<td>1.088502e+06</td>
<td>216.565318</td>
<td>63.085052</td>
<td>1966.907180</td>
<td>1.770760</td>
<td>1.023950e+06</td>
<td>...</td>
<td>0.040008</td>
<td>-0.087298</td>
<td>-2.582011e-14</td>
<td>0.231672</td>
<td>0.340412</td>
<td>0.287822</td>
<td>0.571041</td>
<td>0.537927</td>
<td>0.205466</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">USA</td>
<td>United States</td>
<td>US Dollar</td>
<td>2019</td>
<td>2.086051e+07</td>
<td>2.059584e+07</td>
<td>329.064917</td>
<td>158.299591</td>
<td>1765.346390</td>
<td>3.749341</td>
<td>1.682624e+07</td>
<td>...</td>
<td>0.111490</td>
<td>-0.165832</td>
<td>1.459136e-02</td>
<td>1.005707</td>
<td>0.988310</td>
<td>1.266850</td>
<td>0.717118</td>
<td>0.752818</td>
<td>1.069356</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

<p>7 rows × 50 columns</p>
</div>
</div>
</div>
<p>注意，条件<code>pwt2019['pop'] &gt;= 200</code> 的结果是一列布林值，然后<code>pwt2019[]</code>选择返回取值为<code>True</code>的观测值。</p>
<p>再例如，下面的代码包含了两个条件：</p>
<ul>
<li>国家名属于金砖国家。注意这里使用了Pandas 中的<code>df.isin()</code>函数；</li>
<li>2019年人口超过10亿。</li>
</ul>
<p>当有不止一个条件时，我们用<code>&amp;</code>, <code>|</code>表示<code>and</code> 和 <code>or</code>运算符；</p>
<div id="6e25563f" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>BRICKS <span class="op">=</span> [<span class="st">'China'</span>,<span class="st">'Brazil'</span>,  <span class="st">' Russian Federation'</span>, <span class="st">'India'</span>, <span class="st">'South Africa'</span>]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>pwt2019[(pwt2019[<span class="st">'country'</span>].isin(BRICKS)) <span class="op">&amp;</span> (pwt2019[<span class="st">'pop'</span>] <span class="op">&gt;</span> <span class="dv">1000</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">CHN</td>
<td>China</td>
<td>Yuan Renminbi</td>
<td>2019</td>
<td>20056066.0</td>
<td>20257660.0</td>
<td>1433.783686</td>
<td>798.807739</td>
<td>2168.918848</td>
<td>2.698987</td>
<td>10566063.0</td>
<td>...</td>
<td>0.192402</td>
<td>-0.167672</td>
<td>-0.004101</td>
<td>0.716501</td>
<td>0.679048</td>
<td>0.865375</td>
<td>0.695068</td>
<td>0.734048</td>
<td>0.457278</td>
<td>0.598894</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">IND</td>
<td>India</td>
<td>Indian Rupee</td>
<td>2019</td>
<td>8945547.0</td>
<td>9170555.0</td>
<td>1366.417754</td>
<td>497.615723</td>
<td>2122.940682</td>
<td>2.171165</td>
<td>6608023.5</td>
<td>...</td>
<td>0.051035</td>
<td>-0.077878</td>
<td>0.033701</td>
<td>0.294905</td>
<td>0.356979</td>
<td>0.471800</td>
<td>0.692824</td>
<td>0.672622</td>
<td>0.210450</td>
<td>0.395132</td>
</tr>
</tbody>
</table>

<p>2 rows × 50 columns</p>
</div>
</div>
</div>
<p>更复杂的情况，可以在条件语句中加入数学表达式。例如，下面的代码筛选了人均实际GDP超过2万美元和人口超过5000万的国家的观测值，这里人均实际GDP是购买力平价调整后支出法衡量的实际GDP与人口的比值：</p>
<div id="bf618985" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pwt2019[(pwt2019[<span class="st">'rgdpe'</span>]<span class="op">/</span>pwt2019[<span class="st">'pop'</span>] <span class="op">&gt;</span> <span class="dv">20000</span>) <span class="op">&amp;</span> (pwt2019[<span class="st">'pop'</span>] <span class="op">&gt;</span> <span class="dv">50</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">DEU</td>
<td>Germany</td>
<td>Euro</td>
<td>2019</td>
<td>4.308862e+06</td>
<td>4275312.00</td>
<td>83.517045</td>
<td>44.795197</td>
<td>1386.196834</td>
<td>3.675378</td>
<td>3.078229e+06</td>
<td>...</td>
<td>0.603715</td>
<td>-0.550977</td>
<td>0.000000</td>
<td>0.881662</td>
<td>0.850929</td>
<td>1.006024</td>
<td>0.701677</td>
<td>0.673799</td>
<td>0.822418</td>
<td>0.651490</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">FRA</td>
<td>France</td>
<td>Euro</td>
<td>2019</td>
<td>3.018885e+06</td>
<td>2946958.25</td>
<td>67.351247</td>
<td>28.532564</td>
<td>1504.912353</td>
<td>3.230137</td>
<td>2.233350e+06</td>
<td>...</td>
<td>0.274841</td>
<td>-0.327385</td>
<td>0.022188</td>
<td>0.913003</td>
<td>0.813518</td>
<td>0.987091</td>
<td>0.686175</td>
<td>0.665962</td>
<td>0.716193</td>
<td>0.576515</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">GBR</td>
<td>United Kingdom</td>
<td>Pound Sterling</td>
<td>2019</td>
<td>3.118991e+06</td>
<td>2989895.50</td>
<td>67.530172</td>
<td>32.982498</td>
<td>1667.947711</td>
<td>3.773596</td>
<td>2.414706e+06</td>
<td>...</td>
<td>0.227445</td>
<td>-0.346071</td>
<td>0.065275</td>
<td>0.992262</td>
<td>0.699868</td>
<td>0.912168</td>
<td>0.687633</td>
<td>0.668252</td>
<td>0.624869</td>
<td>0.796017</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ITA</td>
<td>Italy</td>
<td>Euro</td>
<td>2019</td>
<td>2.508404e+06</td>
<td>2466327.50</td>
<td>60.550075</td>
<td>25.596329</td>
<td>1717.833818</td>
<td>3.158385</td>
<td>1.810091e+06</td>
<td>...</td>
<td>0.307117</td>
<td>-0.292341</td>
<td>0.001006</td>
<td>0.846609</td>
<td>0.590234</td>
<td>0.969897</td>
<td>0.704260</td>
<td>0.657741</td>
<td>0.471262</td>
<td>0.585280</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">JPN</td>
<td>Japan</td>
<td>Yen</td>
<td>2019</td>
<td>5.028348e+06</td>
<td>5036891.00</td>
<td>126.860301</td>
<td>69.976692</td>
<td>1691.085260</td>
<td>3.593987</td>
<td>3.765120e+06</td>
<td>...</td>
<td>0.190841</td>
<td>-0.190701</td>
<td>0.005592</td>
<td>1.048585</td>
<td>1.007949</td>
<td>0.932528</td>
<td>0.734816</td>
<td>0.751225</td>
<td>1.011635</td>
<td>0.788685</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">KOR</td>
<td>Republic of Korea</td>
<td>Won</td>
<td>2019</td>
<td>2.090946e+06</td>
<td>2162705.25</td>
<td>51.225308</td>
<td>26.798534</td>
<td>1979.526258</td>
<td>3.765123</td>
<td>1.314779e+06</td>
<td>...</td>
<td>0.466232</td>
<td>-0.403080</td>
<td>0.000459</td>
<td>0.848224</td>
<td>0.732208</td>
<td>0.758751</td>
<td>0.654067</td>
<td>0.701660</td>
<td>0.557140</td>
<td>0.657925</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">RUS</td>
<td>Russian Federation</td>
<td>Russian Ruble</td>
<td>2019</td>
<td>4.197222e+06</td>
<td>4161194.50</td>
<td>145.872256</td>
<td>71.670639</td>
<td>1965.000000</td>
<td>3.434408</td>
<td>3.170826e+06</td>
<td>...</td>
<td>0.178951</td>
<td>-0.086548</td>
<td>-0.023150</td>
<td>0.411263</td>
<td>0.573736</td>
<td>0.281037</td>
<td>0.576825</td>
<td>0.690811</td>
<td>0.466877</td>
<td>0.366449</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">TUR</td>
<td>Turkey</td>
<td>New Turkish Lira</td>
<td>2019</td>
<td>2.227538e+06</td>
<td>2248225.75</td>
<td>83.429615</td>
<td>28.087334</td>
<td>1832.000000</td>
<td>2.514292</td>
<td>1.555716e+06</td>
<td>...</td>
<td>0.119963</td>
<td>-0.147055</td>
<td>0.066752</td>
<td>0.393921</td>
<td>0.313990</td>
<td>0.259054</td>
<td>0.671110</td>
<td>0.636799</td>
<td>0.207867</td>
<td>0.477120</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">USA</td>
<td>United States</td>
<td>US Dollar</td>
<td>2019</td>
<td>2.086051e+07</td>
<td>20595844.00</td>
<td>329.064917</td>
<td>158.299591</td>
<td>1765.346390</td>
<td>3.749341</td>
<td>1.682624e+07</td>
<td>...</td>
<td>0.111490</td>
<td>-0.165832</td>
<td>0.014591</td>
<td>1.005707</td>
<td>0.988310</td>
<td>1.266850</td>
<td>0.717118</td>
<td>0.752818</td>
<td>1.069356</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

<p>9 rows × 50 columns</p>
</div>
</div>
</div>
<p><strong>注意</strong>，当用 Pandas 进行数据筛选时，需要使用 <code>&amp;</code>(<code>|</code>) 而不是 <code>and</code>(<code>or</code>) 来连接多个条件。</p>
<p><code>&amp;</code> 和 <code>|</code> 是 NumPy 的按位运算符，Pandas 借用了它们来实现元素级的逻辑运算:</p>
<ul>
<li><code>&amp;</code> (按位与)：对两个布尔系列中的每个对应元素进行 <code>AND</code> 运算。只有当两个对应元素都为 <code>True</code> 时，结果才为 <code>True</code>。</li>
<li><code>|</code>(按位或)：对两个布尔系列中的每个对应元素进行 <code>OR</code> 运算。只要其中一个对应元素为<code>True</code>，结果就为 <code>True</code>。</li>
</ul>
</section>
</section>
<section id="apply-方法" class="level2">
<h2 class="anchored" data-anchor-id="apply-方法">apply 方法</h2>
<p>Pandas中一个广泛应用的方法是 <code>df.apply()</code>，它将一个函数应用到每一行/列，返回一个序列；</p>
<p>函数可以是内嵌的（built in）也可以是自定义的，例如，计算每一列的最大值，这里使用了Numpy库的max函数：</p>
<div id="d83870eb" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>pwt2019_sub.<span class="bu">apply</span>(np.<span class="bu">max</span>, axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>country       Zimbabwe
rgdpe       20860506.0
rgdpo       20595844.0
pop        1433.783686
emp         798.807739
cgdpe       20791364.0
cgdpo       20566034.0
ctfp          1.276913
dtype: object</code></pre>
</div>
</div>
<p>或者，自定义一个函数<code>range(x)</code>计算极差：</p>
<div id="df7c3fde" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="bu">range</span>(x):</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.<span class="bu">max</span>(x) <span class="op">-</span> np.<span class="bu">min</span>(x)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>pwt2019_sub.select_dtypes(np.number).<span class="bu">apply</span>(<span class="bu">range</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>rgdpe    2.086041e+07
rgdpo    2.059577e+07
pop      1.433779e+03
emp      7.988052e+02
cgdpe    2.079126e+07
cgdpo    2.056595e+07
ctfp     1.222178e+00
dtype: float64</code></pre>
</div>
</div>
<p>再例如，归一化（normalization）经常使用minmax方法： <span class="math display">\[
Y = \frac{X_{i} - \min(X_{i})}{\max(X_{i}) - \min(X_{i})}
\]</span></p>
<p>我们定义一个函数<code>minmax()</code>，然后应用<code>apply()</code>方法：</p>
<div id="dce0df22" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> minmax(S):</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (S<span class="op">-</span>S.<span class="bu">min</span>())<span class="op">/</span>(S.<span class="bu">max</span>() <span class="op">-</span> S.<span class="bu">min</span>())</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>pwt2019[[<span class="st">'pop'</span>,<span class="st">'rgdpe'</span>, <span class="st">'emp'</span>]].<span class="bu">apply</span>(minmax)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">emp</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ABW</td>
<td>0.000071</td>
<td>0.000183</td>
<td>0.000056</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGO</td>
<td>0.022193</td>
<td>0.010932</td>
<td>0.020834</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AIA</td>
<td>0.000007</td>
<td>0.000013</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ALB</td>
<td>0.002006</td>
<td>0.001716</td>
<td>0.001344</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ARE</td>
<td>0.006811</td>
<td>0.032666</td>
<td>0.007269</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VNM</td>
<td>0.067275</td>
<td>0.035983</td>
<td>0.063091</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">YEM</td>
<td>0.020336</td>
<td>0.002395</td>
<td>0.006922</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZAF</td>
<td>0.040838</td>
<td>0.035898</td>
<td>0.023335</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ZMB</td>
<td>0.012454</td>
<td>0.002774</td>
<td>0.006538</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZWE</td>
<td>0.010211</td>
<td>0.002023</td>
<td>0.008548</td>
</tr>
</tbody>
</table>

<p>183 rows × 3 columns</p>
</div>
</div>
</div>
<p>经常将<code>lambda</code>函数方法与<code>df.apply()</code>方法相结合。例如，数据集中有4个指标度量GDP，分别是<code>['rgdpe', 'rgdpo','cgdpe','cgdpo']</code>，假设我们希望计算一个加权平均数，权重为（0.3，0.2，0.3，0.2）：</p>
<div id="2966da92" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>variables <span class="op">=</span> [<span class="st">'rgdpe'</span>, <span class="st">'rgdpo'</span>,<span class="st">'cgdpe'</span>,<span class="st">'cgdpo'</span>]</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>pwt2019[variables].<span class="bu">apply</span>(<span class="kw">lambda</span> row:</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    row[<span class="st">'rgdpe'</span>]<span class="op">*</span><span class="fl">0.3</span> <span class="op">+</span> row[<span class="st">'rgdpo'</span>]<span class="op">*</span><span class="fl">0.2</span> <span class="op">+</span> row[<span class="st">'cgdpe'</span>]<span class="op">*</span><span class="fl">0.3</span> <span class="op">+</span> row[<span class="st">'cgdpo'</span>]<span class="op">*</span><span class="fl">0.2</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>countrycode
ABW      3736.787109
AGO    227005.796875
AIA       318.944458
ALB     35987.785156
ARE    664187.937500
           ...      
VNM    739027.375000
YEM     50759.292969
ZAF    742988.125000
ZMB     57414.339844
ZWE     41768.011719
Length: 183, dtype: float32</code></pre>
</div>
</div>
<p>注意，选项<code>axis = 1</code> ，将函数应用至每一行，默认值为0。</p>
</section>
<section id="检测和处理缺失值" class="level2">
<h2 class="anchored" data-anchor-id="检测和处理缺失值">检测和处理缺失值</h2>
<p>数据集不可避免会遇到存在缺失值的情况。在@sec-reading_data 部分导入数据时，Pandas中最常用的缺失值表示是<code>NaN</code>（Not a Number）。可以使用<code>isnull()</code>或<code>isna()</code>函数检测缺失值，返回一个布尔型的DataFrame，其中<code>True</code>表示缺失值：</p>
<div id="dedddb8e" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pwt2019.isnull()</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>pwt2019.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>country            0
currency_unit      0
year               0
rgdpe              0
rgdpo              0
pop                0
emp                6
avh              117
hc                38
ccon               0
cda                0
cgdpe              0
cgdpo              0
cn                 3
ck                46
ctfp              65
cwtfp             65
rgdpna             0
rconna             0
rdana              0
rnna               3
rkna              46
rtfpna            65
rwtfpna           65
labsh             45
irr               46
delta              3
xr                 0
pl_con             0
pl_da              0
pl_gdpo            0
i_cig              0
i_xm               0
i_xr               0
i_outlier          0
i_irr             46
statcap           56
csh_c              0
csh_i              0
csh_g              0
csh_x              0
csh_m              0
csh_r              0
pl_c               0
pl_i               0
pl_g               0
pl_x               0
pl_m               0
pl_n               3
pl_k              46
dtype: int64</code></pre>
</div>
</div>
<p>下面的的代码计展示了Pandas中链式操作的强大功能，仅用一行命令实现了：</p>
<ul>
<li>计算了缺失值的数量</li>
<li>除以样本容量得到缺失值比例</li>
<li>按照降序排序</li>
<li>并将比例最高的前15个变量绘制柱形图：</li>
</ul>
<div id="60e09106" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>(pwt2019.isna().<span class="bu">sum</span>()<span class="op">/</span>pwt2019.shape[<span class="dv">0</span>] <span class="op">*</span> <span class="dv">100</span>).sort_values(ascending<span class="op">=</span><span class="va">False</span>)[:<span class="dv">15</span>].plot(kind<span class="op">=</span><span class="st">'bar'</span>, ax<span class="op">=</span>ax)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"%"</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="pandas_files/figure-html/cell-31-output-1.png" width="659" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>另一种图示的方法是类似矩阵绘图的方式，将缺失值标记出来，<code>missingno</code>库有简单的命令实现：</p>
<div id="17634042" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> missingno <span class="im">as</span> msno</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">6</span>))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>msno.matrix(pwt2019,sparkline<span class="op">=</span><span class="va">False</span>, ax<span class="op">=</span>ax)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Missing Values Matrix"</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="pandas_files/figure-html/cell-32-output-1.png" width="1141" height="566" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="删除缺失值" class="level3">
<h3 class="anchored" data-anchor-id="删除缺失值">删除缺失值</h3>
<p>处理缺失值的方法有很多种，选择哪种方法取决于你的数据特性、缺失原因以及分析目标。最直接的方法是使用<code>df.dropna()</code>函数删除包含缺失值的行或列：</p>
<div id="ca8c6598" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 删除含缺失值的行</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>pwt2019.dropna()</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 删除含缺失值的列</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>pwt2019.dropna(axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">cda</th>
<th data-quarto-table-cell-role="th">cgdpe</th>
<th data-quarto-table-cell-role="th">cgdpo</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_i</th>
<th data-quarto-table-cell-role="th">csh_g</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ABW</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>2019</td>
<td>3921.261230</td>
<td>3467.299561</td>
<td>0.106314</td>
<td>3023.694824</td>
<td>3877.659668</td>
<td>3912.334717</td>
<td>3466.241943</td>
<td>...</td>
<td>0.246366</td>
<td>0.214084</td>
<td>0.973115</td>
<td>-1.091808</td>
<td>2.125691e-07</td>
<td>0.883092</td>
<td>0.815759</td>
<td>0.744329</td>
<td>0.707260</td>
<td>0.622660</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGO</td>
<td>Angola</td>
<td>Kwanza</td>
<td>2019</td>
<td>228151.015625</td>
<td>227855.718750</td>
<td>31.825295</td>
<td>155943.718750</td>
<td>198750.421875</td>
<td>227771.609375</td>
<td>223289.312500</td>
<td>...</td>
<td>0.191710</td>
<td>0.199723</td>
<td>0.344351</td>
<td>-0.113983</td>
<td>-1.204703e-01</td>
<td>0.438169</td>
<td>0.342872</td>
<td>0.240024</td>
<td>0.476486</td>
<td>0.611627</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AIA</td>
<td>Anguilla</td>
<td>East Caribbean Dollar</td>
<td>2019</td>
<td>376.634979</td>
<td>225.680527</td>
<td>0.014869</td>
<td>438.470032</td>
<td>509.044983</td>
<td>375.136444</td>
<td>241.384537</td>
<td>...</td>
<td>0.292376</td>
<td>0.303098</td>
<td>1.480300</td>
<td>-2.445801</td>
<td>-1.433542e-01</td>
<td>1.064513</td>
<td>1.029199</td>
<td>0.732212</td>
<td>0.768944</td>
<td>0.602734</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ALB</td>
<td>Albania</td>
<td>Lek</td>
<td>2019</td>
<td>35890.019531</td>
<td>36103.042969</td>
<td>2.880917</td>
<td>33399.167969</td>
<td>40868.316406</td>
<td>35808.343750</td>
<td>36288.328125</td>
<td>...</td>
<td>0.205828</td>
<td>0.206071</td>
<td>0.126594</td>
<td>-0.313949</td>
<td>6.114468e-02</td>
<td>0.473077</td>
<td>0.456882</td>
<td>0.235589</td>
<td>0.629832</td>
<td>0.525463</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ARE</td>
<td>United Arab Emirates</td>
<td>UAE Dirham</td>
<td>2019</td>
<td>681525.812500</td>
<td>645956.250000</td>
<td>9.770529</td>
<td>306771.156250</td>
<td>515623.312500</td>
<td>678241.187500</td>
<td>635332.812500</td>
<td>...</td>
<td>0.328729</td>
<td>0.127105</td>
<td>0.889652</td>
<td>-0.701231</td>
<td>-4.849206e-07</td>
<td>0.725061</td>
<td>0.480580</td>
<td>0.692488</td>
<td>0.688882</td>
<td>0.647336</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VNM</td>
<td>Viet Nam</td>
<td>Dong</td>
<td>2019</td>
<td>750726.750000</td>
<td>724123.375000</td>
<td>96.462106</td>
<td>582677.062500</td>
<td>758821.937500</td>
<td>747853.750000</td>
<td>723142.687500</td>
<td>...</td>
<td>0.243582</td>
<td>0.095490</td>
<td>0.526032</td>
<td>-0.518066</td>
<td>-5.730492e-02</td>
<td>0.347591</td>
<td>0.399158</td>
<td>0.245056</td>
<td>0.695617</td>
<td>0.676502</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">YEM</td>
<td>Yemen</td>
<td>Yemeni Rial</td>
<td>2019</td>
<td>50052.933594</td>
<td>51828.058594</td>
<td>29.161922</td>
<td>49266.472656</td>
<td>67992.531250</td>
<td>49937.042969</td>
<td>51983.429688</td>
<td>...</td>
<td>0.360231</td>
<td>0.300234</td>
<td>0.000723</td>
<td>-0.135297</td>
<td>-1.733917e-01</td>
<td>0.777612</td>
<td>0.238807</td>
<td>0.211786</td>
<td>0.632594</td>
<td>0.670528</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZAF</td>
<td>South Africa</td>
<td>Rand</td>
<td>2019</td>
<td>748940.000000</td>
<td>734094.375000</td>
<td>58.558270</td>
<td>623669.562500</td>
<td>741675.937500</td>
<td>748245.937500</td>
<td>735067.062500</td>
<td>...</td>
<td>0.160538</td>
<td>0.227329</td>
<td>0.184207</td>
<td>-0.198112</td>
<td>4.914912e-03</td>
<td>0.463660</td>
<td>0.523813</td>
<td>0.447869</td>
<td>0.660216</td>
<td>0.604546</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ZMB</td>
<td>Zambia</td>
<td>Kwacha</td>
<td>2019</td>
<td>57956.183594</td>
<td>56783.714844</td>
<td>17.861030</td>
<td>38698.402344</td>
<td>56536.863281</td>
<td>57695.066406</td>
<td>56811.105469</td>
<td>...</td>
<td>0.313996</td>
<td>0.171331</td>
<td>0.215397</td>
<td>-0.238961</td>
<td>2.839118e-02</td>
<td>0.373077</td>
<td>0.482041</td>
<td>0.330470</td>
<td>0.574416</td>
<td>0.531915</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZWE</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>2019</td>
<td>42296.062500</td>
<td>40826.570312</td>
<td>14.645468</td>
<td>43961.839844</td>
<td>47128.785156</td>
<td>42325.117188</td>
<td>41081.722656</td>
<td>...</td>
<td>0.077089</td>
<td>0.227109</td>
<td>0.213562</td>
<td>-0.270959</td>
<td>-8.979837e-02</td>
<td>0.494755</td>
<td>0.652439</td>
<td>0.500927</td>
<td>0.487763</td>
<td>0.430082</td>
</tr>
</tbody>
</table>

<p>183 rows × 32 columns</p>
</div>
</div>
</div>
<p>上面的命令并没有改变原数据框，可以通过赋值方式保存删除后数据，或者使用<code>df.dropna(inplace=True)</code>，即在原数据框中生效。</p>
</section>
<section id="数值填充" class="level3">
<h3 class="anchored" data-anchor-id="数值填充">数值填充</h3>
<p>数值型变量缺失值处理中最简单的是用某个值进行填充，<code>df.fillna()</code>是核心函数。</p>
<p>在Penn World Data中有几个变量是分类变量，如i_icg, i_xm等，参见数据集Excel表中“Data information variables”的说明。如果简单使用<code>pwt2019.fillna(0)</code>的命令会报错。我们小需要只对数值型列的缺失值（NaN）进行填充，而其他非数值型列（如分类变量、文本等）则保持原样。下面的链式命令需要简单的说明：</p>
<ul>
<li><p><code>.select_dtypes(np.number)</code>筛选出所有数据类型为数值型（numeric）的列变量；</p></li>
<li><p><code>.fillna(0)</code>对筛选后的数据框上，用0填充缺失值；</p></li>
<li><p><code>.combine_first(pwt2019)</code>，是整个命令中最关键的一步。combine_first 是一个强大的方法，它将两个 DataFrame 按索引和列名进行合并。它的工作原理是：</p>
<ul>
<li>对于每一个位置（即索引和列），它首先查看调用者（也就是 .fillna(0) 之后得到的那个填充了 0 的数值型 DataFrame）的值。</li>
<li>如果调用者的值不是缺失值（NaN），就使用这个值。</li>
<li>如果调用者的值是缺失值（NaN），它就会去使用参数 pwt2019 中对应位置的值。</li>
</ul></li>
</ul>
<p>由于第一步已经将非数值型列移除了，因此在 <code>.fillna(0)</code> 之后的 DataFrame 中，这些被移除的列全部变成了 <code>NaN</code>，就会使用 <code>pwt2019</code> 中对应位置的值。 - 最后按照初始变量<code>pwt2019.columns</code>的顺序重新排列数据。</p>
<div id="ba192c9b" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>pwt2019.select_dtypes(np.number).fillna(<span class="dv">0</span>).combine_first(pwt2019)[pwt2019.columns]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ABW</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>2019</td>
<td>3921.261230</td>
<td>3467.299561</td>
<td>0.106314</td>
<td>0.047601</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3023.694824</td>
<td>...</td>
<td>0.973115</td>
<td>-1.091808</td>
<td>2.125691e-07</td>
<td>0.883092</td>
<td>0.815759</td>
<td>0.744329</td>
<td>0.707260</td>
<td>0.622660</td>
<td>0.805100</td>
<td>0.648114</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGO</td>
<td>Angola</td>
<td>Kwanza</td>
<td>2019</td>
<td>228151.015625</td>
<td>227855.718750</td>
<td>31.825295</td>
<td>16.644962</td>
<td>0.000000</td>
<td>1.481984</td>
<td>155943.718750</td>
<td>...</td>
<td>0.344351</td>
<td>-0.113983</td>
<td>-1.204703e-01</td>
<td>0.438169</td>
<td>0.342872</td>
<td>0.240024</td>
<td>0.476486</td>
<td>0.611627</td>
<td>0.211084</td>
<td>0.396034</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AIA</td>
<td>Anguilla</td>
<td>East Caribbean Dollar</td>
<td>2019</td>
<td>376.634979</td>
<td>225.680527</td>
<td>0.014869</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>438.470032</td>
<td>...</td>
<td>1.480300</td>
<td>-2.445801</td>
<td>-1.433542e-01</td>
<td>1.064513</td>
<td>1.029199</td>
<td>0.732212</td>
<td>0.768944</td>
<td>0.602734</td>
<td>0.897989</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ALB</td>
<td>Albania</td>
<td>Lek</td>
<td>2019</td>
<td>35890.019531</td>
<td>36103.042969</td>
<td>2.880917</td>
<td>1.075898</td>
<td>0.000000</td>
<td>2.964992</td>
<td>33399.167969</td>
<td>...</td>
<td>0.126594</td>
<td>-0.313949</td>
<td>6.114468e-02</td>
<td>0.473077</td>
<td>0.456882</td>
<td>0.235589</td>
<td>0.629832</td>
<td>0.525463</td>
<td>0.300975</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ARE</td>
<td>United Arab Emirates</td>
<td>UAE Dirham</td>
<td>2019</td>
<td>681525.812500</td>
<td>645956.250000</td>
<td>9.770529</td>
<td>5.808834</td>
<td>0.000000</td>
<td>2.746695</td>
<td>306771.156250</td>
<td>...</td>
<td>0.889652</td>
<td>-0.701231</td>
<td>-4.849206e-07</td>
<td>0.725061</td>
<td>0.480580</td>
<td>0.692488</td>
<td>0.688882</td>
<td>0.647336</td>
<td>0.270424</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VNM</td>
<td>Viet Nam</td>
<td>Dong</td>
<td>2019</td>
<td>750726.750000</td>
<td>724123.375000</td>
<td>96.462106</td>
<td>50.399563</td>
<td>2131.968232</td>
<td>2.869998</td>
<td>582677.062500</td>
<td>...</td>
<td>0.526032</td>
<td>-0.518066</td>
<td>-5.730492e-02</td>
<td>0.347591</td>
<td>0.399158</td>
<td>0.245056</td>
<td>0.695617</td>
<td>0.676502</td>
<td>0.249708</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">YEM</td>
<td>Yemen</td>
<td>Yemeni Rial</td>
<td>2019</td>
<td>50052.933594</td>
<td>51828.058594</td>
<td>29.161922</td>
<td>5.531877</td>
<td>0.000000</td>
<td>1.842989</td>
<td>49266.472656</td>
<td>...</td>
<td>0.000723</td>
<td>-0.135297</td>
<td>-1.733917e-01</td>
<td>0.777612</td>
<td>0.238807</td>
<td>0.211786</td>
<td>0.632594</td>
<td>0.670528</td>
<td>0.174729</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZAF</td>
<td>South Africa</td>
<td>Rand</td>
<td>2019</td>
<td>748940.000000</td>
<td>734094.375000</td>
<td>58.558270</td>
<td>18.642710</td>
<td>2191.363362</td>
<td>2.908202</td>
<td>623669.562500</td>
<td>...</td>
<td>0.184207</td>
<td>-0.198112</td>
<td>4.914912e-03</td>
<td>0.463660</td>
<td>0.523813</td>
<td>0.447869</td>
<td>0.660216</td>
<td>0.604546</td>
<td>0.315006</td>
<td>0.525546</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ZMB</td>
<td>Zambia</td>
<td>Kwacha</td>
<td>2019</td>
<td>57956.183594</td>
<td>56783.714844</td>
<td>17.861030</td>
<td>5.225448</td>
<td>0.000000</td>
<td>2.686845</td>
<td>38698.402344</td>
<td>...</td>
<td>0.215397</td>
<td>-0.238961</td>
<td>2.839118e-02</td>
<td>0.373077</td>
<td>0.482041</td>
<td>0.330470</td>
<td>0.574416</td>
<td>0.531915</td>
<td>0.295188</td>
<td>0.360382</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZWE</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>2019</td>
<td>42296.062500</td>
<td>40826.570312</td>
<td>14.645468</td>
<td>6.831017</td>
<td>0.000000</td>
<td>2.713408</td>
<td>43961.839844</td>
<td>...</td>
<td>0.213562</td>
<td>-0.270959</td>
<td>-8.979837e-02</td>
<td>0.494755</td>
<td>0.652439</td>
<td>0.500927</td>
<td>0.487763</td>
<td>0.430082</td>
<td>0.419883</td>
<td>1.580885</td>
</tr>
</tbody>
</table>

<p>183 rows × 50 columns</p>
</div>
</div>
</div>
<p>除了0值外，常使用平均值或中位数来进行数值填充。下面的命令在计算均值/中位数时，使用了<code>numeric_only=True</code>参数只对数值型变量进行操作：</p>
<div id="d55b4c1a" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pwt2019.select_dtypes(np.number).fillna(pwt2019.mean(numeric_only<span class="op">=</span><span class="va">True</span>)).combine_first(pwt2019)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pwt2019.select_dtypes(np.number).fillna(pwt2019.median(numeric_only=True)).combine_first(pwt2019)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">cda</th>
<th data-quarto-table-cell-role="th">cgdpe</th>
<th data-quarto-table-cell-role="th">cgdpo</th>
<th data-quarto-table-cell-role="th">ck</th>
<th data-quarto-table-cell-role="th">cn</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">csh_c</th>
<th data-quarto-table-cell-role="th">csh_g</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpna</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">rkna</th>
<th data-quarto-table-cell-role="th">rnna</th>
<th data-quarto-table-cell-role="th">rtfpna</th>
<th data-quarto-table-cell-role="th">rwtfpna</th>
<th data-quarto-table-cell-role="th">statcap</th>
<th data-quarto-table-cell-role="th">xr</th>
<th data-quarto-table-cell-role="th">year</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ABW</td>
<td>1849.981084</td>
<td>3023.694824</td>
<td>3877.659668</td>
<td>3912.334717</td>
<td>3466.241943</td>
<td>0.000209</td>
<td>1.742797e+04</td>
<td>Aruba</td>
<td>0.658242</td>
<td>0.214084</td>
<td>...</td>
<td>3921.261230</td>
<td>3068.758301</td>
<td>3467.299561</td>
<td>1.032467</td>
<td>1.739027e+04</td>
<td>0.989679</td>
<td>0.994500</td>
<td>67.279097</td>
<td>1.790000</td>
<td>2019</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGO</td>
<td>1849.981084</td>
<td>155943.718750</td>
<td>198750.421875</td>
<td>227771.609375</td>
<td>223289.312500</td>
<td>0.016624</td>
<td>1.299232e+06</td>
<td>Angola</td>
<td>0.498670</td>
<td>0.199723</td>
<td>...</td>
<td>228151.015625</td>
<td>222151.062500</td>
<td>227855.718750</td>
<td>1.005457</td>
<td>1.300951e+06</td>
<td>0.936524</td>
<td>0.916698</td>
<td>48.888900</td>
<td>364.825805</td>
<td>2019</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AIA</td>
<td>1849.981084</td>
<td>438.470032</td>
<td>509.044983</td>
<td>375.136444</td>
<td>241.384537</td>
<td>0.046314</td>
<td>2.266816e+03</td>
<td>Anguilla</td>
<td>1.513381</td>
<td>0.303098</td>
<td>...</td>
<td>376.634979</td>
<td>223.456711</td>
<td>225.680527</td>
<td>1.079724</td>
<td>2.260053e+03</td>
<td>0.989679</td>
<td>0.994500</td>
<td>67.279097</td>
<td>2.700000</td>
<td>2019</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ALB</td>
<td>1849.981084</td>
<td>33399.167969</td>
<td>40868.316406</td>
<td>35808.343750</td>
<td>36288.328125</td>
<td>0.046314</td>
<td>2.239714e+05</td>
<td>Albania</td>
<td>0.714312</td>
<td>0.206071</td>
<td>...</td>
<td>35890.019531</td>
<td>37204.773438</td>
<td>36103.042969</td>
<td>1.079724</td>
<td>2.226235e+05</td>
<td>0.989679</td>
<td>0.994500</td>
<td>78.888900</td>
<td>109.850833</td>
<td>2019</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ARE</td>
<td>1849.981084</td>
<td>306771.156250</td>
<td>515623.312500</td>
<td>678241.187500</td>
<td>635332.812500</td>
<td>0.046314</td>
<td>4.453746e+06</td>
<td>United Arab Emirates</td>
<td>0.355746</td>
<td>0.127105</td>
<td>...</td>
<td>681525.812500</td>
<td>647986.250000</td>
<td>645956.250000</td>
<td>1.079724</td>
<td>4.454460e+06</td>
<td>0.989679</td>
<td>0.994500</td>
<td>67.279097</td>
<td>3.672500</td>
<td>2019</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VNM</td>
<td>2131.968232</td>
<td>582677.062500</td>
<td>758821.937500</td>
<td>747853.750000</td>
<td>723142.687500</td>
<td>0.046314</td>
<td>1.962286e+06</td>
<td>Viet Nam</td>
<td>0.710267</td>
<td>0.095490</td>
<td>...</td>
<td>750726.750000</td>
<td>741653.562500</td>
<td>724123.375000</td>
<td>1.079724</td>
<td>1.964750e+06</td>
<td>0.989679</td>
<td>0.994500</td>
<td>78.888900</td>
<td>23050.241667</td>
<td>2019</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">YEM</td>
<td>1849.981084</td>
<td>49266.472656</td>
<td>67992.531250</td>
<td>49937.042969</td>
<td>51983.429688</td>
<td>0.046314</td>
<td>5.312318e+05</td>
<td>Yemen</td>
<td>0.647500</td>
<td>0.300234</td>
<td>...</td>
<td>50052.933594</td>
<td>40069.593750</td>
<td>51828.058594</td>
<td>1.079724</td>
<td>5.404372e+05</td>
<td>0.989679</td>
<td>0.994500</td>
<td>38.888867</td>
<td>250.250000</td>
<td>2019</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZAF</td>
<td>2191.363362</td>
<td>623669.562500</td>
<td>741675.937500</td>
<td>748245.937500</td>
<td>735067.062500</td>
<td>0.033228</td>
<td>2.816883e+06</td>
<td>South Africa</td>
<td>0.621124</td>
<td>0.227329</td>
<td>...</td>
<td>748940.000000</td>
<td>732851.625000</td>
<td>734094.375000</td>
<td>1.036546</td>
<td>2.811258e+06</td>
<td>0.965773</td>
<td>0.972355</td>
<td>75.555567</td>
<td>14.448427</td>
<td>2019</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ZMB</td>
<td>1849.981084</td>
<td>38698.402344</td>
<td>56536.863281</td>
<td>57695.066406</td>
<td>56811.105469</td>
<td>0.004523</td>
<td>2.841112e+05</td>
<td>Zambia</td>
<td>0.509846</td>
<td>0.171331</td>
<td>...</td>
<td>57956.183594</td>
<td>56282.273438</td>
<td>56783.714844</td>
<td>1.117712</td>
<td>2.851388e+05</td>
<td>0.955966</td>
<td>0.921073</td>
<td>55.555567</td>
<td>12.889418</td>
<td>2019</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZWE</td>
<td>1849.981084</td>
<td>43961.839844</td>
<td>47128.785156</td>
<td>42325.117188</td>
<td>41081.722656</td>
<td>0.000733</td>
<td>5.939553e+04</td>
<td>Zimbabwe</td>
<td>0.842998</td>
<td>0.227109</td>
<td>...</td>
<td>42296.062500</td>
<td>42694.070312</td>
<td>40826.570312</td>
<td>1.055221</td>
<td>5.974304e+04</td>
<td>0.910977</td>
<td>0.902522</td>
<td>56.666633</td>
<td>1.000000</td>
<td>2019</td>
</tr>
</tbody>
</table>

<p>183 rows × 50 columns</p>
</div>
</div>
</div>
<p>也可以使用向后填充（backward fill），即用一个观测值向其后面（更低索引位置）的缺失值来填充这个缺失值；或向前填充（forward fill）</p>
<div id="6edface1" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pwt2019.fillna(method='ffill')</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>pwt2019.fillna(method<span class="op">=</span><span class="st">'bfill'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\admin\AppData\Local\Temp\ipykernel_5424\1604694572.py:2: FutureWarning: DataFrame.fillna with 'method' is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  pwt2019.fillna(method='bfill')</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ABW</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>2019</td>
<td>3921.261230</td>
<td>3467.299561</td>
<td>0.106314</td>
<td>0.047601</td>
<td>1609.068998</td>
<td>1.481984</td>
<td>3023.694824</td>
<td>...</td>
<td>0.973115</td>
<td>-1.091808</td>
<td>2.125691e-07</td>
<td>0.883092</td>
<td>0.815759</td>
<td>0.744329</td>
<td>0.707260</td>
<td>0.622660</td>
<td>0.805100</td>
<td>0.648114</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGO</td>
<td>Angola</td>
<td>Kwanza</td>
<td>2019</td>
<td>228151.015625</td>
<td>227855.718750</td>
<td>31.825295</td>
<td>16.644962</td>
<td>1609.068998</td>
<td>1.481984</td>
<td>155943.718750</td>
<td>...</td>
<td>0.344351</td>
<td>-0.113983</td>
<td>-1.204703e-01</td>
<td>0.438169</td>
<td>0.342872</td>
<td>0.240024</td>
<td>0.476486</td>
<td>0.611627</td>
<td>0.211084</td>
<td>0.396034</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AIA</td>
<td>Anguilla</td>
<td>East Caribbean Dollar</td>
<td>2019</td>
<td>376.634979</td>
<td>225.680527</td>
<td>0.014869</td>
<td>1.075898</td>
<td>1609.068998</td>
<td>2.964992</td>
<td>438.470032</td>
<td>...</td>
<td>1.480300</td>
<td>-2.445801</td>
<td>-1.433542e-01</td>
<td>1.064513</td>
<td>1.029199</td>
<td>0.732212</td>
<td>0.768944</td>
<td>0.602734</td>
<td>0.897989</td>
<td>0.793385</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ALB</td>
<td>Albania</td>
<td>Lek</td>
<td>2019</td>
<td>35890.019531</td>
<td>36103.042969</td>
<td>2.880917</td>
<td>1.075898</td>
<td>1609.068998</td>
<td>2.964992</td>
<td>33399.167969</td>
<td>...</td>
<td>0.126594</td>
<td>-0.313949</td>
<td>6.114468e-02</td>
<td>0.473077</td>
<td>0.456882</td>
<td>0.235589</td>
<td>0.629832</td>
<td>0.525463</td>
<td>0.300975</td>
<td>0.793385</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ARE</td>
<td>United Arab Emirates</td>
<td>UAE Dirham</td>
<td>2019</td>
<td>681525.812500</td>
<td>645956.250000</td>
<td>9.770529</td>
<td>5.808834</td>
<td>1609.068998</td>
<td>2.746695</td>
<td>306771.156250</td>
<td>...</td>
<td>0.889652</td>
<td>-0.701231</td>
<td>-4.849206e-07</td>
<td>0.725061</td>
<td>0.480580</td>
<td>0.692488</td>
<td>0.688882</td>
<td>0.647336</td>
<td>0.270424</td>
<td>0.793385</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VNM</td>
<td>Viet Nam</td>
<td>Dong</td>
<td>2019</td>
<td>750726.750000</td>
<td>724123.375000</td>
<td>96.462106</td>
<td>50.399563</td>
<td>2131.968232</td>
<td>2.869998</td>
<td>582677.062500</td>
<td>...</td>
<td>0.526032</td>
<td>-0.518066</td>
<td>-5.730492e-02</td>
<td>0.347591</td>
<td>0.399158</td>
<td>0.245056</td>
<td>0.695617</td>
<td>0.676502</td>
<td>0.249708</td>
<td>0.525546</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">YEM</td>
<td>Yemen</td>
<td>Yemeni Rial</td>
<td>2019</td>
<td>50052.933594</td>
<td>51828.058594</td>
<td>29.161922</td>
<td>5.531877</td>
<td>2191.363362</td>
<td>1.842989</td>
<td>49266.472656</td>
<td>...</td>
<td>0.000723</td>
<td>-0.135297</td>
<td>-1.733917e-01</td>
<td>0.777612</td>
<td>0.238807</td>
<td>0.211786</td>
<td>0.632594</td>
<td>0.670528</td>
<td>0.174729</td>
<td>0.525546</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZAF</td>
<td>South Africa</td>
<td>Rand</td>
<td>2019</td>
<td>748940.000000</td>
<td>734094.375000</td>
<td>58.558270</td>
<td>18.642710</td>
<td>2191.363362</td>
<td>2.908202</td>
<td>623669.562500</td>
<td>...</td>
<td>0.184207</td>
<td>-0.198112</td>
<td>4.914912e-03</td>
<td>0.463660</td>
<td>0.523813</td>
<td>0.447869</td>
<td>0.660216</td>
<td>0.604546</td>
<td>0.315006</td>
<td>0.525546</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ZMB</td>
<td>Zambia</td>
<td>Kwacha</td>
<td>2019</td>
<td>57956.183594</td>
<td>56783.714844</td>
<td>17.861030</td>
<td>5.225448</td>
<td>NaN</td>
<td>2.686845</td>
<td>38698.402344</td>
<td>...</td>
<td>0.215397</td>
<td>-0.238961</td>
<td>2.839118e-02</td>
<td>0.373077</td>
<td>0.482041</td>
<td>0.330470</td>
<td>0.574416</td>
<td>0.531915</td>
<td>0.295188</td>
<td>0.360382</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZWE</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>2019</td>
<td>42296.062500</td>
<td>40826.570312</td>
<td>14.645468</td>
<td>6.831017</td>
<td>NaN</td>
<td>2.713408</td>
<td>43961.839844</td>
<td>...</td>
<td>0.213562</td>
<td>-0.270959</td>
<td>-8.979837e-02</td>
<td>0.494755</td>
<td>0.652439</td>
<td>0.500927</td>
<td>0.487763</td>
<td>0.430082</td>
<td>0.419883</td>
<td>1.580885</td>
</tr>
</tbody>
</table>

<p>183 rows × 50 columns</p>
</div>
</div>
</div>
<p>另外，<code>.fillna()</code>函数可以根据定义的字典，不同的列用不同的值填充。</p>
<div id="28c5456a" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> {<span class="st">"pop"</span>:<span class="fl">0.01</span>, <span class="st">'emp'</span>:<span class="fl">0.005</span>, <span class="st">"ctfp"</span>: <span class="fl">0.1</span>,}</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>pwt2019_sub.fillna(values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">cgdpe</th>
<th data-quarto-table-cell-role="th">cgdpo</th>
<th data-quarto-table-cell-role="th">ctfp</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ABW</td>
<td>Aruba</td>
<td>3921.261230</td>
<td>3467.299561</td>
<td>0.106314</td>
<td>0.047601</td>
<td>3912.334717</td>
<td>3466.241943</td>
<td>0.100000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGO</td>
<td>Angola</td>
<td>228151.015625</td>
<td>227855.718750</td>
<td>31.825295</td>
<td>16.644962</td>
<td>227771.609375</td>
<td>223289.312500</td>
<td>0.387996</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AIA</td>
<td>Anguilla</td>
<td>376.634979</td>
<td>225.680527</td>
<td>0.014869</td>
<td>0.005000</td>
<td>375.136444</td>
<td>241.384537</td>
<td>0.100000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ALB</td>
<td>Albania</td>
<td>35890.019531</td>
<td>36103.042969</td>
<td>2.880917</td>
<td>1.075898</td>
<td>35808.343750</td>
<td>36288.328125</td>
<td>0.100000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ARE</td>
<td>United Arab Emirates</td>
<td>681525.812500</td>
<td>645956.250000</td>
<td>9.770529</td>
<td>5.808834</td>
<td>678241.187500</td>
<td>635332.812500</td>
<td>0.100000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VNM</td>
<td>Viet Nam</td>
<td>750726.750000</td>
<td>724123.375000</td>
<td>96.462106</td>
<td>50.399563</td>
<td>747853.750000</td>
<td>723142.687500</td>
<td>0.100000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">YEM</td>
<td>Yemen</td>
<td>50052.933594</td>
<td>51828.058594</td>
<td>29.161922</td>
<td>5.531877</td>
<td>49937.042969</td>
<td>51983.429688</td>
<td>0.100000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZAF</td>
<td>South Africa</td>
<td>748940.000000</td>
<td>734094.375000</td>
<td>58.558270</td>
<td>18.642710</td>
<td>748245.937500</td>
<td>735067.062500</td>
<td>0.547630</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ZMB</td>
<td>Zambia</td>
<td>57956.183594</td>
<td>56783.714844</td>
<td>17.861030</td>
<td>5.225448</td>
<td>57695.066406</td>
<td>56811.105469</td>
<td>0.261406</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZWE</td>
<td>Zimbabwe</td>
<td>42296.062500</td>
<td>40826.570312</td>
<td>14.645468</td>
<td>6.831017</td>
<td>42325.117188</td>
<td>41081.722656</td>
<td>0.374524</td>
</tr>
</tbody>
</table>

<p>183 rows × 8 columns</p>
</div>
</div>
</div>
</section>
<section id="插值法interpolation" class="level3">
<h3 class="anchored" data-anchor-id="插值法interpolation">插值法（Interpolation）</h3>
<p>除了填充给定值以外，也有更复杂的插值法。例如线性插值法。</p>
<div id="fig-linear_interpolation" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linear_interpolation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/linear_interpolation.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linear_interpolation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: 线性插值法
</figcaption>
</figure>
</div>
<p>假设已知两个点 <span class="math inline">\((x_{0},y_{0})\)</span> 和 <span class="math inline">\(x_{1}, y_{1}\)</span>，线性插值法意味着满足方程： <span class="math display">\[
\frac{y-y_{0}}{x-x_{0}} = \frac{y_{1}-y_{0}}{x_{1}-x_{0}}
\]</span></p>
<div id="5642ed40" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series([<span class="dv">0</span>, <span class="dv">1</span>, np.nan, <span class="dv">3</span>])</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>s.interpolate()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>0    0.0
1    1.0
2    2.0
3    3.0
dtype: float64</code></pre>
</div>
</div>
<p>将其应用至数值型变量：</p>
<div id="e0babcec" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>pwt2019.select_dtypes(np.number).interpolate(method<span class="op">=</span><span class="st">"linear"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">cda</th>
<th data-quarto-table-cell-role="th">cgdpe</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ABW</td>
<td>2019</td>
<td>3921.261230</td>
<td>3467.299561</td>
<td>0.106314</td>
<td>0.047601</td>
<td>NaN</td>
<td>NaN</td>
<td>3023.694824</td>
<td>3877.659668</td>
<td>3912.334717</td>
<td>...</td>
<td>0.973115</td>
<td>-1.091808</td>
<td>2.125691e-07</td>
<td>0.883092</td>
<td>0.815759</td>
<td>0.744329</td>
<td>0.707260</td>
<td>0.622660</td>
<td>0.805100</td>
<td>0.648114</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGO</td>
<td>2019</td>
<td>228151.015625</td>
<td>227855.718750</td>
<td>31.825295</td>
<td>16.644962</td>
<td>NaN</td>
<td>1.481984</td>
<td>155943.718750</td>
<td>198750.421875</td>
<td>227771.609375</td>
<td>...</td>
<td>0.344351</td>
<td>-0.113983</td>
<td>-1.204703e-01</td>
<td>0.438169</td>
<td>0.342872</td>
<td>0.240024</td>
<td>0.476486</td>
<td>0.611627</td>
<td>0.211084</td>
<td>0.396034</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AIA</td>
<td>2019</td>
<td>376.634979</td>
<td>225.680527</td>
<td>0.014869</td>
<td>8.860430</td>
<td>NaN</td>
<td>2.223488</td>
<td>438.470032</td>
<td>509.044983</td>
<td>375.136444</td>
<td>...</td>
<td>1.480300</td>
<td>-2.445801</td>
<td>-1.433542e-01</td>
<td>1.064513</td>
<td>1.029199</td>
<td>0.732212</td>
<td>0.768944</td>
<td>0.602734</td>
<td>0.897989</td>
<td>0.495372</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ALB</td>
<td>2019</td>
<td>35890.019531</td>
<td>36103.042969</td>
<td>2.880917</td>
<td>1.075898</td>
<td>NaN</td>
<td>2.964992</td>
<td>33399.167969</td>
<td>40868.316406</td>
<td>35808.343750</td>
<td>...</td>
<td>0.126594</td>
<td>-0.313949</td>
<td>6.114468e-02</td>
<td>0.473077</td>
<td>0.456882</td>
<td>0.235589</td>
<td>0.629832</td>
<td>0.525463</td>
<td>0.300975</td>
<td>0.594710</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ARE</td>
<td>2019</td>
<td>681525.812500</td>
<td>645956.250000</td>
<td>9.770529</td>
<td>5.808834</td>
<td>NaN</td>
<td>2.746695</td>
<td>306771.156250</td>
<td>515623.312500</td>
<td>678241.187500</td>
<td>...</td>
<td>0.889652</td>
<td>-0.701231</td>
<td>-4.849206e-07</td>
<td>0.725061</td>
<td>0.480580</td>
<td>0.692488</td>
<td>0.688882</td>
<td>0.647336</td>
<td>0.270424</td>
<td>0.694047</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VNM</td>
<td>2019</td>
<td>750726.750000</td>
<td>724123.375000</td>
<td>96.462106</td>
<td>50.399563</td>
<td>2131.968232</td>
<td>2.869998</td>
<td>582677.062500</td>
<td>758821.937500</td>
<td>747853.750000</td>
<td>...</td>
<td>0.526032</td>
<td>-0.518066</td>
<td>-5.730492e-02</td>
<td>0.347591</td>
<td>0.399158</td>
<td>0.245056</td>
<td>0.695617</td>
<td>0.676502</td>
<td>0.249708</td>
<td>1.485950</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">YEM</td>
<td>2019</td>
<td>50052.933594</td>
<td>51828.058594</td>
<td>29.161922</td>
<td>5.531877</td>
<td>2161.665797</td>
<td>1.842989</td>
<td>49266.472656</td>
<td>67992.531250</td>
<td>49937.042969</td>
<td>...</td>
<td>0.000723</td>
<td>-0.135297</td>
<td>-1.733917e-01</td>
<td>0.777612</td>
<td>0.238807</td>
<td>0.211786</td>
<td>0.632594</td>
<td>0.670528</td>
<td>0.174729</td>
<td>1.005748</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZAF</td>
<td>2019</td>
<td>748940.000000</td>
<td>734094.375000</td>
<td>58.558270</td>
<td>18.642710</td>
<td>2191.363362</td>
<td>2.908202</td>
<td>623669.562500</td>
<td>741675.937500</td>
<td>748245.937500</td>
<td>...</td>
<td>0.184207</td>
<td>-0.198112</td>
<td>4.914912e-03</td>
<td>0.463660</td>
<td>0.523813</td>
<td>0.447869</td>
<td>0.660216</td>
<td>0.604546</td>
<td>0.315006</td>
<td>0.525546</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ZMB</td>
<td>2019</td>
<td>57956.183594</td>
<td>56783.714844</td>
<td>17.861030</td>
<td>5.225448</td>
<td>2191.363362</td>
<td>2.686845</td>
<td>38698.402344</td>
<td>56536.863281</td>
<td>57695.066406</td>
<td>...</td>
<td>0.215397</td>
<td>-0.238961</td>
<td>2.839118e-02</td>
<td>0.373077</td>
<td>0.482041</td>
<td>0.330470</td>
<td>0.574416</td>
<td>0.531915</td>
<td>0.295188</td>
<td>0.360382</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZWE</td>
<td>2019</td>
<td>42296.062500</td>
<td>40826.570312</td>
<td>14.645468</td>
<td>6.831017</td>
<td>2191.363362</td>
<td>2.713408</td>
<td>43961.839844</td>
<td>47128.785156</td>
<td>42325.117188</td>
<td>...</td>
<td>0.213562</td>
<td>-0.270959</td>
<td>-8.979837e-02</td>
<td>0.494755</td>
<td>0.652439</td>
<td>0.500927</td>
<td>0.487763</td>
<td>0.430082</td>
<td>0.419883</td>
<td>1.580885</td>
</tr>
</tbody>
</table>

<p>183 rows × 43 columns</p>
</div>
</div>
</div>
</section>
<section id="应用长期经济增长" class="level3">
<h3 class="anchored" data-anchor-id="应用长期经济增长">应用：长期经济增长</h3>
<p><a href="https://www.rug.nl/ggdc/historicaldevelopment/maddison/releases/maddison-project-database-2023">Maddison Project Database 2023</a>是基于经济史学家Angus Maddison 的研究构建的长期经济增长数据库，主要包含人均GDP（gdppc）和人口（pop）数据，最早至公元1年，中间有大量的缺失值。</p>
<p>我们下载并载入数据，来绘制一幅：</p>
<div id="e8de7644" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>mpd <span class="op">=</span> pd.read_excel(<span class="st">"datasets/mpd2023_web.xlsx"</span>, sheet_name<span class="op">=</span><span class="st">"Full data"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>gdp_pc <span class="op">=</span> mpd.set_index([<span class="st">'countrycode'</span>, <span class="st">'year'</span>])[<span class="st">'gdppc'</span>].unstack(<span class="st">'countrycode'</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>gdp_pc.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th">AFG</th>
<th data-quarto-table-cell-role="th">AGO</th>
<th data-quarto-table-cell-role="th">ALB</th>
<th data-quarto-table-cell-role="th">ARE</th>
<th data-quarto-table-cell-role="th">ARG</th>
<th data-quarto-table-cell-role="th">ARM</th>
<th data-quarto-table-cell-role="th">AUS</th>
<th data-quarto-table-cell-role="th">AUT</th>
<th data-quarto-table-cell-role="th">AZE</th>
<th data-quarto-table-cell-role="th">BDI</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">URY</th>
<th data-quarto-table-cell-role="th">USA</th>
<th data-quarto-table-cell-role="th">UZB</th>
<th data-quarto-table-cell-role="th">VEN</th>
<th data-quarto-table-cell-role="th">VNM</th>
<th data-quarto-table-cell-role="th">YEM</th>
<th data-quarto-table-cell-role="th">YUG</th>
<th data-quarto-table-cell-role="th">ZAF</th>
<th data-quarto-table-cell-role="th">ZMB</th>
<th data-quarto-table-cell-role="th">ZWE</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2018</td>
<td>1888.813928</td>
<td>7180.355235</td>
<td>11426.920105</td>
<td>74206.484938</td>
<td>18460.869009</td>
<td>11490.368687</td>
<td>49614.385976</td>
<td>43032.216404</td>
<td>16753.209691</td>
<td>730.904598</td>
<td>...</td>
<td>19697.759966</td>
<td>55454.669438</td>
<td>10682.417894</td>
<td>9446.187715</td>
<td>6842.138813</td>
<td>2281.544865</td>
<td>16824.553739</td>
<td>11873.299868</td>
<td>3521.505006</td>
<td>1900.199191</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2019</td>
<td>2031.737349</td>
<td>6886.954136</td>
<td>11715.306318</td>
<td>74396.143863</td>
<td>17912.635765</td>
<td>12399.231837</td>
<td>49814.669956</td>
<td>43488.668121</td>
<td>17029.906374</td>
<td>738.983078</td>
<td>...</td>
<td>19714.148949</td>
<td>56469.263659</td>
<td>11219.242900</td>
<td>7061.761533</td>
<td>7266.048396</td>
<td>2265.343020</td>
<td>17524.212183</td>
<td>11739.935508</td>
<td>3466.236413</td>
<td>1753.024449</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2020</td>
<td>1928.454683</td>
<td>6279.929085</td>
<td>11372.541421</td>
<td>70188.272728</td>
<td>15975.838773</td>
<td>11546.175310</td>
<td>48268.945077</td>
<td>40503.040806</td>
<td>16189.511047</td>
<td>720.445974</td>
<td>...</td>
<td>18460.038349</td>
<td>54379.206512</td>
<td>11341.919402</td>
<td>4952.529595</td>
<td>7395.361527</td>
<td>2031.443613</td>
<td>16757.938552</td>
<td>10839.133081</td>
<td>3270.599223</td>
<td>1585.972804</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2021</td>
<td>1485.547006</td>
<td>6137.003845</td>
<td>12455.916554</td>
<td>72460.040688</td>
<td>17470.682415</td>
<td>12242.477472</td>
<td>50704.934853</td>
<td>42184.696121</td>
<td>16971.724515</td>
<td>723.192074</td>
<td>...</td>
<td>19222.295835</td>
<td>57522.704626</td>
<td>12076.091577</td>
<td>4896.801879</td>
<td>7507.758707</td>
<td>1972.210254</td>
<td>18491.681774</td>
<td>11273.159112</td>
<td>3321.594496</td>
<td>1687.253154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2022</td>
<td>1357.987823</td>
<td>6118.904897</td>
<td>12978.100729</td>
<td>77203.670241</td>
<td>18292.317825</td>
<td>13837.577589</td>
<td>52049.427952</td>
<td>43792.856400</td>
<td>17682.940199</td>
<td>717.228429</td>
<td>...</td>
<td>20181.939663</td>
<td>58487.465861</td>
<td>12559.401550</td>
<td>5267.175305</td>
<td>8050.358831</td>
<td>1959.319498</td>
<td>19352.383894</td>
<td>11415.886895</td>
<td>3342.421325</td>
<td>1703.529373</td>
</tr>
</tbody>
</table>

<p>5 rows × 169 columns</p>
</div>
</div>
</div>
<p>由于中间有缺失值，绘制的图形出现大段的空白，因此，我们用线性插值法补充，用虚线表示：</p>
<div id="d6835881" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>countries <span class="op">=</span> [<span class="st">'CHN'</span>, <span class="st">'GBR'</span>, <span class="st">'USA'</span>]</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'blue'</span>,<span class="st">'red'</span>,<span class="st">'green'</span>]</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> country, color <span class="kw">in</span> <span class="bu">zip</span>(countries, colors):</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    ax.plot(gdp_pc[country], linewidth <span class="op">=</span> <span class="dv">2</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>        label <span class="op">=</span> country,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> color)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    ax.plot(gdp_pc[country].interpolate(),</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>            linestyle <span class="op">=</span> <span class="st">'--'</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>            lw<span class="op">=</span><span class="dv">2</span>, color <span class="op">=</span> color)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"GDP per Capita, 1000- (China, UK, USA)"</span>)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="pandas_files/figure-html/cell-41-output-1.png" width="758" height="566" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>更复杂的方法涉及到模型估计问题，如KNN预测等。Scikit-learn库有专门的方法，这里就不多涉及。</p>
<div id="ad668582" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>imputer_mean <span class="op">=</span> SimpleImputer(strategy<span class="op">=</span><span class="st">'mean'</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(imputer_mean.fit_transform(pwt2019.select_dtypes(np.number)), columns<span class="op">=</span>pwt2019.select_dtypes(np.number).columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">cda</th>
<th data-quarto-table-cell-role="th">cgdpe</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2019.0</td>
<td>3921.261230</td>
<td>3467.299561</td>
<td>0.106314</td>
<td>0.047601</td>
<td>1849.981084</td>
<td>2.709271</td>
<td>3023.694824</td>
<td>3877.659668</td>
<td>3912.334717</td>
<td>...</td>
<td>0.973115</td>
<td>-1.091808</td>
<td>2.125691e-07</td>
<td>0.883092</td>
<td>0.815759</td>
<td>0.744329</td>
<td>0.707260</td>
<td>0.622660</td>
<td>0.805100</td>
<td>0.648114</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2019.0</td>
<td>228151.015625</td>
<td>227855.718750</td>
<td>31.825295</td>
<td>16.644962</td>
<td>1849.981084</td>
<td>1.481984</td>
<td>155943.718750</td>
<td>198750.421875</td>
<td>227771.609375</td>
<td>...</td>
<td>0.344351</td>
<td>-0.113983</td>
<td>-1.204703e-01</td>
<td>0.438169</td>
<td>0.342872</td>
<td>0.240024</td>
<td>0.476486</td>
<td>0.611627</td>
<td>0.211084</td>
<td>0.396034</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2019.0</td>
<td>376.634979</td>
<td>225.680527</td>
<td>0.014869</td>
<td>18.736708</td>
<td>1849.981084</td>
<td>2.709271</td>
<td>438.470032</td>
<td>509.044983</td>
<td>375.136444</td>
<td>...</td>
<td>1.480300</td>
<td>-2.445801</td>
<td>-1.433542e-01</td>
<td>1.064513</td>
<td>1.029199</td>
<td>0.732212</td>
<td>0.768944</td>
<td>0.602734</td>
<td>0.897989</td>
<td>0.835094</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2019.0</td>
<td>35890.019531</td>
<td>36103.042969</td>
<td>2.880917</td>
<td>1.075898</td>
<td>1849.981084</td>
<td>2.964992</td>
<td>33399.167969</td>
<td>40868.316406</td>
<td>35808.343750</td>
<td>...</td>
<td>0.126594</td>
<td>-0.313949</td>
<td>6.114468e-02</td>
<td>0.473077</td>
<td>0.456882</td>
<td>0.235589</td>
<td>0.629832</td>
<td>0.525463</td>
<td>0.300975</td>
<td>0.835094</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2019.0</td>
<td>681525.812500</td>
<td>645956.250000</td>
<td>9.770529</td>
<td>5.808834</td>
<td>1849.981084</td>
<td>2.746695</td>
<td>306771.156250</td>
<td>515623.312500</td>
<td>678241.187500</td>
<td>...</td>
<td>0.889652</td>
<td>-0.701231</td>
<td>-4.849206e-07</td>
<td>0.725061</td>
<td>0.480580</td>
<td>0.692488</td>
<td>0.688882</td>
<td>0.647336</td>
<td>0.270424</td>
<td>0.835094</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">178</td>
<td>2019.0</td>
<td>750726.750000</td>
<td>724123.375000</td>
<td>96.462106</td>
<td>50.399563</td>
<td>2131.968232</td>
<td>2.869998</td>
<td>582677.062500</td>
<td>758821.937500</td>
<td>747853.750000</td>
<td>...</td>
<td>0.526032</td>
<td>-0.518066</td>
<td>-5.730492e-02</td>
<td>0.347591</td>
<td>0.399158</td>
<td>0.245056</td>
<td>0.695617</td>
<td>0.676502</td>
<td>0.249708</td>
<td>0.835094</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">179</td>
<td>2019.0</td>
<td>50052.933594</td>
<td>51828.058594</td>
<td>29.161922</td>
<td>5.531877</td>
<td>1849.981084</td>
<td>1.842989</td>
<td>49266.472656</td>
<td>67992.531250</td>
<td>49937.042969</td>
<td>...</td>
<td>0.000723</td>
<td>-0.135297</td>
<td>-1.733917e-01</td>
<td>0.777612</td>
<td>0.238807</td>
<td>0.211786</td>
<td>0.632594</td>
<td>0.670528</td>
<td>0.174729</td>
<td>0.835094</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">180</td>
<td>2019.0</td>
<td>748940.000000</td>
<td>734094.375000</td>
<td>58.558270</td>
<td>18.642710</td>
<td>2191.363362</td>
<td>2.908202</td>
<td>623669.562500</td>
<td>741675.937500</td>
<td>748245.937500</td>
<td>...</td>
<td>0.184207</td>
<td>-0.198112</td>
<td>4.914912e-03</td>
<td>0.463660</td>
<td>0.523813</td>
<td>0.447869</td>
<td>0.660216</td>
<td>0.604546</td>
<td>0.315006</td>
<td>0.525546</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">181</td>
<td>2019.0</td>
<td>57956.183594</td>
<td>56783.714844</td>
<td>17.861030</td>
<td>5.225448</td>
<td>1849.981084</td>
<td>2.686845</td>
<td>38698.402344</td>
<td>56536.863281</td>
<td>57695.066406</td>
<td>...</td>
<td>0.215397</td>
<td>-0.238961</td>
<td>2.839118e-02</td>
<td>0.373077</td>
<td>0.482041</td>
<td>0.330470</td>
<td>0.574416</td>
<td>0.531915</td>
<td>0.295188</td>
<td>0.360382</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">182</td>
<td>2019.0</td>
<td>42296.062500</td>
<td>40826.570312</td>
<td>14.645468</td>
<td>6.831017</td>
<td>1849.981084</td>
<td>2.713408</td>
<td>43961.839844</td>
<td>47128.785156</td>
<td>42325.117188</td>
<td>...</td>
<td>0.213562</td>
<td>-0.270959</td>
<td>-8.979837e-02</td>
<td>0.494755</td>
<td>0.652439</td>
<td>0.500927</td>
<td>0.487763</td>
<td>0.430082</td>
<td>0.419883</td>
<td>1.580885</td>
</tr>
</tbody>
</table>

<p>183 rows × 43 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="异常值" class="level2">
<h2 class="anchored" data-anchor-id="异常值">异常值</h2>
<p>异常值的存在可能对数据运算结果产生较大的影响。</p>
<section id="异常值的检测" class="level3">
<h3 class="anchored" data-anchor-id="异常值的检测">异常值的检测</h3>
<p>可以计算统计量或图形的方法来检测是否存在异常值。这里介绍常用的Z-Score方法： <span class="math display">\[
Z = \frac{x - \mu}{\sigma}
\]</span></p>
<p>它度量了一个数据点与均值之间以标准差为单位的距离，当数据近似正态分布的时候适合使用。将Z-Score超过某个阈值（如2或3）的数据点，视为异常值。</p>
<p>如果是对数据框操作，可以应用<code>apply()</code>函数：</p>
<div id="b433003e" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>pd.options.display.float_format <span class="op">=</span> <span class="st">'</span><span class="sc">{:.3f}</span><span class="st">'</span>.<span class="bu">format</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>zscore <span class="op">=</span> pwt2019.select_dtypes(np.number).<span class="bu">apply</span>(<span class="kw">lambda</span> x: (x<span class="op">-</span>x.mean(axis<span class="op">=</span><span class="dv">0</span>))<span class="op">/</span>x.std(axis<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>pwt2019[zscore[<span class="st">'pop'</span>]<span class="op">&gt;</span><span class="dv">3</span>][<span class="st">'pop'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>countrycode
CHN   1433.784
IND   1366.418
Name: pop, dtype: float64</code></pre>
</div>
</div>
<p>另外一种方法是根据四分位距（Interquartile Range，IQR），令 <span class="math inline">\(IQR = Q_{3} - Q_{1}\)</span>，在 <span class="math inline">\(Q_{1} - 1.5\cdot IQR\)</span> 或 <span class="math inline">\(Q_{3} + 1.5\cdot IQR\)</span> 范围之外的数据点是异常值。</p>
<div id="db62ea05" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> iqr_outlier(ser):</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    Q1 <span class="op">=</span> ser.quantile(<span class="fl">0.25</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    Q3 <span class="op">=</span> ser.quantile(<span class="fl">0.75</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    lower_bound <span class="op">=</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    upper_bound <span class="op">=</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    outlier <span class="op">=</span> (ser <span class="op">&lt;</span> lower_bound) <span class="op">|</span> (ser <span class="op">&gt;</span> upper_bound)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> outlier</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>pwt2019[iqr_outlier(pwt2019[<span class="st">'pop'</span>])][[<span class="st">'country'</span>, <span class="st">'pop'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">pop</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">BGD</td>
<td>Bangladesh</td>
<td>163.046</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">BRA</td>
<td>Brazil</td>
<td>211.050</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">CHN</td>
<td>China</td>
<td>1433.784</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">COD</td>
<td>D.R. of the Congo</td>
<td>86.791</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">DEU</td>
<td>Germany</td>
<td>83.517</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">EGY</td>
<td>Egypt</td>
<td>100.388</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ETH</td>
<td>Ethiopia</td>
<td>112.079</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">IDN</td>
<td>Indonesia</td>
<td>270.626</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">IND</td>
<td>India</td>
<td>1366.418</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">IRN</td>
<td>Iran (Islamic Republic of)</td>
<td>82.914</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">JPN</td>
<td>Japan</td>
<td>126.860</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MEX</td>
<td>Mexico</td>
<td>127.576</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">NGA</td>
<td>Nigeria</td>
<td>200.964</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">PAK</td>
<td>Pakistan</td>
<td>216.565</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">PHL</td>
<td>Philippines</td>
<td>108.117</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">RUS</td>
<td>Russian Federation</td>
<td>145.872</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">TUR</td>
<td>Turkey</td>
<td>83.430</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">USA</td>
<td>United States</td>
<td>329.065</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VNM</td>
<td>Viet Nam</td>
<td>96.462</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>通常IQR方法是采用箱形图的形式展示的，如图所示，位于 <span class="math inline">\(Q_{3}\)</span> 上方1.5倍IQR的观测值，以散点的形式展现出来。</p>
<div id="4ac00751" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>ax.boxplot(x<span class="op">=</span>pwt2019[<span class="st">'pop'</span>])</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="pandas_files/figure-html/cell-45-output-1.png" width="658" height="485" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="缩尾处理" class="level3">
<h3 class="anchored" data-anchor-id="缩尾处理">缩尾处理</h3>
<p>应用中，常需要对异常值进行一定的处理，其中一种方法是缩尾处理（Winsorize），将极端值替换为某个百分位数的值，例如，将上限设为 99 百分位数，下限设为 1 百分位数。</p>
<p>可以使用<code>df.clip()</code>函数实现，例如全要素生产率水平<code>ctfp</code>：</p>
<div id="d78a996c" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>q95 <span class="op">=</span> pwt2019[<span class="st">'ctfp'</span>].quantile(<span class="fl">0.95</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>q05 <span class="op">=</span> pwt2019[<span class="st">'ctfp'</span>].quantile(<span class="fl">0.05</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>pwt2019[<span class="st">'ctfp'</span>].dropna().clip(lower<span class="op">=</span>q05, upper<span class="op">=</span>q95, inplace<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>countrycode
AGO   0.388
ARG   0.829
ARM   0.838
AUS   0.838
AUT   0.829
       ... 
USA   1.000
VEN   0.267
ZAF   0.548
ZMB   0.267
ZWE   0.375
Name: ctfp, Length: 118, dtype: float32</code></pre>
</div>
</div>
</section>
</section>
<section id="观测值排序" class="level2">
<h2 class="anchored" data-anchor-id="观测值排序">观测值排序</h2>
<p>有时候需要对数据集进行一定的排序，Pandas中可以按索引(<code>df.sort_index</code>)和值（<code>df.sort_values</code>）排序。</p>
<section id="根据索引排序" class="level3">
<h3 class="anchored" data-anchor-id="根据索引排序">根据索引排序</h3>
<p>例如，将索引按降序排序，这里的索引是国家代码，因此升序/降序是按照字母顺序：</p>
<div id="715b7998" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>pwt2019.sort_index(ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZWE</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>2019</td>
<td>42296.062</td>
<td>40826.570</td>
<td>14.645</td>
<td>6.831</td>
<td>NaN</td>
<td>2.713</td>
<td>43961.840</td>
<td>...</td>
<td>0.214</td>
<td>-0.271</td>
<td>-0.090</td>
<td>0.495</td>
<td>0.652</td>
<td>0.501</td>
<td>0.488</td>
<td>0.430</td>
<td>0.420</td>
<td>1.581</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ZMB</td>
<td>Zambia</td>
<td>Kwacha</td>
<td>2019</td>
<td>57956.184</td>
<td>56783.715</td>
<td>17.861</td>
<td>5.225</td>
<td>NaN</td>
<td>2.687</td>
<td>38698.402</td>
<td>...</td>
<td>0.215</td>
<td>-0.239</td>
<td>0.028</td>
<td>0.373</td>
<td>0.482</td>
<td>0.330</td>
<td>0.574</td>
<td>0.532</td>
<td>0.295</td>
<td>0.360</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZAF</td>
<td>South Africa</td>
<td>Rand</td>
<td>2019</td>
<td>748940.000</td>
<td>734094.375</td>
<td>58.558</td>
<td>18.643</td>
<td>2191.363</td>
<td>2.908</td>
<td>623669.562</td>
<td>...</td>
<td>0.184</td>
<td>-0.198</td>
<td>0.005</td>
<td>0.464</td>
<td>0.524</td>
<td>0.448</td>
<td>0.660</td>
<td>0.605</td>
<td>0.315</td>
<td>0.526</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">YEM</td>
<td>Yemen</td>
<td>Yemeni Rial</td>
<td>2019</td>
<td>50052.934</td>
<td>51828.059</td>
<td>29.162</td>
<td>5.532</td>
<td>NaN</td>
<td>1.843</td>
<td>49266.473</td>
<td>...</td>
<td>0.001</td>
<td>-0.135</td>
<td>-0.173</td>
<td>0.778</td>
<td>0.239</td>
<td>0.212</td>
<td>0.633</td>
<td>0.671</td>
<td>0.175</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VNM</td>
<td>Viet Nam</td>
<td>Dong</td>
<td>2019</td>
<td>750726.750</td>
<td>724123.375</td>
<td>96.462</td>
<td>50.400</td>
<td>2131.968</td>
<td>2.870</td>
<td>582677.062</td>
<td>...</td>
<td>0.526</td>
<td>-0.518</td>
<td>-0.057</td>
<td>0.348</td>
<td>0.399</td>
<td>0.245</td>
<td>0.696</td>
<td>0.677</td>
<td>0.250</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ARE</td>
<td>United Arab Emirates</td>
<td>UAE Dirham</td>
<td>2019</td>
<td>681525.812</td>
<td>645956.250</td>
<td>9.771</td>
<td>5.809</td>
<td>NaN</td>
<td>2.747</td>
<td>306771.156</td>
<td>...</td>
<td>0.890</td>
<td>-0.701</td>
<td>-0.000</td>
<td>0.725</td>
<td>0.481</td>
<td>0.692</td>
<td>0.689</td>
<td>0.647</td>
<td>0.270</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ALB</td>
<td>Albania</td>
<td>Lek</td>
<td>2019</td>
<td>35890.020</td>
<td>36103.043</td>
<td>2.881</td>
<td>1.076</td>
<td>NaN</td>
<td>2.965</td>
<td>33399.168</td>
<td>...</td>
<td>0.127</td>
<td>-0.314</td>
<td>0.061</td>
<td>0.473</td>
<td>0.457</td>
<td>0.236</td>
<td>0.630</td>
<td>0.525</td>
<td>0.301</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AIA</td>
<td>Anguilla</td>
<td>East Caribbean Dollar</td>
<td>2019</td>
<td>376.635</td>
<td>225.681</td>
<td>0.015</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>438.470</td>
<td>...</td>
<td>1.480</td>
<td>-2.446</td>
<td>-0.143</td>
<td>1.065</td>
<td>1.029</td>
<td>0.732</td>
<td>0.769</td>
<td>0.603</td>
<td>0.898</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGO</td>
<td>Angola</td>
<td>Kwanza</td>
<td>2019</td>
<td>228151.016</td>
<td>227855.719</td>
<td>31.825</td>
<td>16.645</td>
<td>NaN</td>
<td>1.482</td>
<td>155943.719</td>
<td>...</td>
<td>0.344</td>
<td>-0.114</td>
<td>-0.120</td>
<td>0.438</td>
<td>0.343</td>
<td>0.240</td>
<td>0.476</td>
<td>0.612</td>
<td>0.211</td>
<td>0.396</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ABW</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>2019</td>
<td>3921.261</td>
<td>3467.300</td>
<td>0.106</td>
<td>0.048</td>
<td>NaN</td>
<td>NaN</td>
<td>3023.695</td>
<td>...</td>
<td>0.973</td>
<td>-1.092</td>
<td>0.000</td>
<td>0.883</td>
<td>0.816</td>
<td>0.744</td>
<td>0.707</td>
<td>0.623</td>
<td>0.805</td>
<td>0.648</td>
</tr>
</tbody>
</table>

<p>183 rows × 50 columns</p>
</div>
</div>
</div>
</section>
<section id="根据值排序" class="level3">
<h3 class="anchored" data-anchor-id="根据值排序">根据值排序</h3>
<p>来看<code>df.sort_values</code>的例子，假设我们希望按2019年的人均GDP（PPP链式调整后）降序（令<code>ascending=False</code>）排列：</p>
<div id="2569d880" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>pwt2019[<span class="st">'rgdp_per'</span>] <span class="op">=</span> pwt2019[<span class="st">'rgdpe'</span>]<span class="op">/</span>pwt2019[<span class="st">'pop'</span>]</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>pwt2019.sort_values(by<span class="op">=</span><span class="st">'rgdp_per'</span>, ascending<span class="op">=</span><span class="va">False</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
<th data-quarto-table-cell-role="th">rgdp_per</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">LUX</td>
<td>Luxembourg</td>
<td>Euro</td>
<td>2019</td>
<td>69541.328</td>
<td>55710.793</td>
<td>0.616</td>
<td>0.461</td>
<td>1505.559</td>
<td>3.620</td>
<td>27761.588</td>
<td>...</td>
<td>-0.635</td>
<td>0.472</td>
<td>1.068</td>
<td>0.746</td>
<td>1.494</td>
<td>0.699</td>
<td>0.635</td>
<td>0.680</td>
<td>1.278</td>
<td>112941.453</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">MAC</td>
<td>China, Macao SAR</td>
<td>Pataca</td>
<td>2019</td>
<td>67463.125</td>
<td>59874.164</td>
<td>0.640</td>
<td>0.388</td>
<td>NaN</td>
<td>2.962</td>
<td>23970.996</td>
<td>...</td>
<td>-0.288</td>
<td>0.705</td>
<td>0.786</td>
<td>0.793</td>
<td>0.848</td>
<td>0.709</td>
<td>0.695</td>
<td>0.575</td>
<td>2.026</td>
<td>105337.890</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">QAT</td>
<td>Qatar</td>
<td>Qatari Rial</td>
<td>2019</td>
<td>292963.531</td>
<td>323141.156</td>
<td>2.832</td>
<td>2.084</td>
<td>NaN</td>
<td>3.259</td>
<td>86421.289</td>
<td>...</td>
<td>-0.144</td>
<td>-0.101</td>
<td>0.887</td>
<td>0.496</td>
<td>0.891</td>
<td>0.527</td>
<td>0.649</td>
<td>0.333</td>
<td>0.602</td>
<td>103445.127</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">IRL</td>
<td>Ireland</td>
<td>Euro</td>
<td>2019</td>
<td>499741.094</td>
<td>501053.594</td>
<td>4.882</td>
<td>2.260</td>
<td>1771.978</td>
<td>3.186</td>
<td>149572.484</td>
<td>...</td>
<td>-0.339</td>
<td>-0.045</td>
<td>1.094</td>
<td>0.648</td>
<td>1.103</td>
<td>0.671</td>
<td>0.603</td>
<td>0.557</td>
<td>0.924</td>
<td>102353.631</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">SGP</td>
<td>Singapore</td>
<td>Singapore Dollar</td>
<td>2019</td>
<td>514376.312</td>
<td>477907.875</td>
<td>5.804</td>
<td>3.760</td>
<td>2330.166</td>
<td>4.352</td>
<td>229661.500</td>
<td>...</td>
<td>-1.117</td>
<td>0.205</td>
<td>0.762</td>
<td>0.687</td>
<td>0.709</td>
<td>0.712</td>
<td>0.673</td>
<td>0.465</td>
<td>0.947</td>
<td>88619.305</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">MWI</td>
<td>Malawi</td>
<td>Kwacha</td>
<td>2019</td>
<td>20362.393</td>
<td>21635.066</td>
<td>18.629</td>
<td>7.950</td>
<td>NaN</td>
<td>2.039</td>
<td>20989.887</td>
<td>...</td>
<td>-0.242</td>
<td>0.078</td>
<td>0.363</td>
<td>0.653</td>
<td>0.380</td>
<td>0.620</td>
<td>0.560</td>
<td>0.474</td>
<td>NaN</td>
<td>1093.063</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">COD</td>
<td>D.R. of the Congo</td>
<td>Franc Congolais</td>
<td>2019</td>
<td>89061.672</td>
<td>88673.375</td>
<td>86.791</td>
<td>25.140</td>
<td>NaN</td>
<td>1.679</td>
<td>78981.922</td>
<td>...</td>
<td>-0.098</td>
<td>-0.059</td>
<td>0.460</td>
<td>0.950</td>
<td>0.540</td>
<td>0.647</td>
<td>0.657</td>
<td>0.621</td>
<td>NaN</td>
<td>1026.168</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">CAF</td>
<td>Central African Republic</td>
<td>CFA Franc BEAC</td>
<td>2019</td>
<td>4532.561</td>
<td>4642.449</td>
<td>4.745</td>
<td>1.844</td>
<td>NaN</td>
<td>1.562</td>
<td>5007.588</td>
<td>...</td>
<td>-0.132</td>
<td>-0.126</td>
<td>0.496</td>
<td>0.670</td>
<td>0.333</td>
<td>0.686</td>
<td>0.632</td>
<td>0.376</td>
<td>0.637</td>
<td>955.192</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">BDI</td>
<td>Burundi</td>
<td>Burundi Franc</td>
<td>2019</td>
<td>8664.988</td>
<td>9109.688</td>
<td>11.531</td>
<td>5.004</td>
<td>NaN</td>
<td>1.417</td>
<td>9894.192</td>
<td>...</td>
<td>-0.252</td>
<td>0.008</td>
<td>0.330</td>
<td>0.543</td>
<td>0.304</td>
<td>0.650</td>
<td>0.476</td>
<td>0.351</td>
<td>0.513</td>
<td>751.479</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VEN</td>
<td>Venezuela (Bolivarian Republic of)</td>
<td>Bolivar Fuerte</td>
<td>2019</td>
<td>7166.572</td>
<td>7160.107</td>
<td>28.516</td>
<td>11.694</td>
<td>NaN</td>
<td>2.893</td>
<td>9266.067</td>
<td>...</td>
<td>-0.001</td>
<td>-0.403</td>
<td>18.144</td>
<td>34.445</td>
<td>14.176</td>
<td>0.581</td>
<td>0.646</td>
<td>20.695</td>
<td>12.002</td>
<td>251.319</td>
</tr>
</tbody>
</table>

<p>183 rows × 51 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="数据集合并" class="level2">
<h2 class="anchored" data-anchor-id="数据集合并">数据集合并</h2>
<p>在Pandas中，数据集合并是一个非常常见的操作，它允许你将多个DataFrame或Series根据某种关系组合成一个新的数据结构。Pandas提供了几个强大的函数来处理数据合并，如 <a href="#tbl-merge_data" class="quarto-xref">Table&nbsp;1</a> 所示，它们各有侧重，适用于不同的场景，更多详细内容参见官方文档<a href="https://pandas.pydata.org/pandas-docs/version/1.1/user_guide/merging.html">Merge, join, concatenate and compare</a>。</p>
<div id="tbl-merge_data" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-merge_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: 数据集的合并
</figcaption>
<div aria-describedby="tbl-merge_data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 19%">
<col style="width: 18%">
<col style="width: 10%">
<col style="width: 42%">
</colgroup>
<thead>
<tr class="header">
<th>函数</th>
<th>主要功能</th>
<th>默认连接方式</th>
<th>主要对齐方式</th>
<th>典型用途</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>concat()</td>
<td>按轴堆叠，合并</td>
<td>按行（axis=0），outer</td>
<td>索引</td>
<td>拼接多个DataFrame，例如将多个文件的数据读入后合并</td>
</tr>
<tr class="even">
<td>merge()</td>
<td>根据键连接</td>
<td>inner</td>
<td>键（列名）</td>
<td>根据共同的列将两个或多个DataFrame关联起来，类似于SQL JOIN</td>
</tr>
<tr class="odd">
<td>.join()</td>
<td>根据索引连接</td>
<td>left</td>
<td>索引</td>
<td>基于索引的快速连接，通常用于连接有相同索引的数据集</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<section id="pd.concat" class="level3">
<h3 class="anchored" data-anchor-id="pd.concat"><code>pd.concat()</code></h3>
<p><code>concat()</code> 函数主要用于按轴（行或列）堆叠数据，它不对数据进行智能对齐，而是简单地将两个或多个DataFrame或Series沿着指定的轴拼接起来。</p>
<div id="ea01c3d1" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>bricks <span class="op">=</span> [<span class="st">'CHN'</span>, <span class="st">'BRA'</span>, <span class="st">'RUS'</span>, <span class="st">'IND'</span>, <span class="st">'ZAF'</span>]</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>europe <span class="op">=</span> [<span class="st">'GBR'</span>, <span class="st">'NOR'</span>, <span class="st">'SWE'</span>,<span class="st">'ESP'</span>]</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>asia <span class="op">=</span> [<span class="st">'JPN'</span>,<span class="st">'KOR'</span>,<span class="st">'SGP'</span>]</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>variables <span class="op">=</span> [<span class="st">'country'</span>, <span class="st">'rgdpe'</span>, <span class="st">'pop'</span>]</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pwt2019.loc[bricks, variables]</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pwt2019.loc[europe, variables]</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> pwt2019.loc[asia, variables]</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>pd.concat([df1, df2, df3])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">pop</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">CHN</td>
<td>China</td>
<td>20056066.000</td>
<td>1433.784</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">BRA</td>
<td>Brazil</td>
<td>3089273.500</td>
<td>211.050</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">RUS</td>
<td>Russian Federation</td>
<td>4197222.500</td>
<td>145.872</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">IND</td>
<td>India</td>
<td>8945547.000</td>
<td>1366.418</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZAF</td>
<td>South Africa</td>
<td>748940.000</td>
<td>58.558</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">GBR</td>
<td>United Kingdom</td>
<td>3118991.250</td>
<td>67.530</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">NOR</td>
<td>Norway</td>
<td>336415.406</td>
<td>5.379</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SWE</td>
<td>Sweden</td>
<td>560960.500</td>
<td>10.036</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ESP</td>
<td>Spain</td>
<td>1932678.625</td>
<td>46.737</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">JPN</td>
<td>Japan</td>
<td>5028348.000</td>
<td>126.860</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">KOR</td>
<td>Republic of Korea</td>
<td>2090945.875</td>
<td>51.225</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SGP</td>
<td>Singapore</td>
<td>514376.312</td>
<td>5.804</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>默认是按列堆叠，即<code>axis=0</code>。</p>
<div id="49403cf0" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>variables2 <span class="op">=</span> [<span class="st">'emp'</span>,<span class="st">'avh'</span>]</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>df4 <span class="op">=</span> pwt2019.loc[bricks, variables2]</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>pd.concat([df1, df4], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">CHN</td>
<td>China</td>
<td>20056066.000</td>
<td>1433.784</td>
<td>798.808</td>
<td>2168.919</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">BRA</td>
<td>Brazil</td>
<td>3089273.500</td>
<td>211.050</td>
<td>93.957</td>
<td>1707.795</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">RUS</td>
<td>Russian Federation</td>
<td>4197222.500</td>
<td>145.872</td>
<td>71.671</td>
<td>1965.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">IND</td>
<td>India</td>
<td>8945547.000</td>
<td>1366.418</td>
<td>497.616</td>
<td>2122.941</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZAF</td>
<td>South Africa</td>
<td>748940.000</td>
<td>58.558</td>
<td>18.643</td>
<td>2191.363</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="merge" class="level3">
<h3 class="anchored" data-anchor-id="merge">Merge</h3>
<p>实际应用中，数据可能来自不同的来源，经常需要合并数据集。<code>pd.merge()</code>函数是最常用和最强大的合并函数，用于根据一个或多个键（列或索引）将两个DataFrame连接起来。</p>
<div id="b368eba3" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span>(pd.merge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Help on function merge in module pandas.core.reshape.merge:

merge(
    left: 'DataFrame | Series',
    right: 'DataFrame | Series',
    how: 'MergeHow' = 'inner',
    on: 'IndexLabel | AnyArrayLike | None' = None,
    left_on: 'IndexLabel | AnyArrayLike | None' = None,
    right_on: 'IndexLabel | AnyArrayLike | None' = None,
    left_index: 'bool' = False,
    right_index: 'bool' = False,
    sort: 'bool' = False,
    suffixes: 'Suffixes' = ('_x', '_y'),
    copy: 'bool | None' = None,
    indicator: 'str | bool' = False,
    validate: 'str | None' = None
) -&gt; 'DataFrame'
    Merge DataFrame or named Series objects with a database-style join.

    A named Series object is treated as a DataFrame with a single named column.

    The join is done on columns or indexes. If joining columns on
    columns, the DataFrame indexes *will be ignored*. Otherwise if joining indexes
    on indexes or indexes on a column or columns, the index will be passed on.
    When performing a cross merge, no column specifications to merge on are
    allowed.

    .. warning::

        If both key columns contain rows where the key is a null value, those
        rows will be matched against each other. This is different from usual SQL
        join behaviour and can lead to unexpected results.

    Parameters
    ----------
    left : DataFrame or named Series
    right : DataFrame or named Series
        Object to merge with.
    how : {'left', 'right', 'outer', 'inner', 'cross'}, default 'inner'
        Type of merge to be performed.

        * left: use only keys from left frame, similar to a SQL left outer join;
          preserve key order.
        * right: use only keys from right frame, similar to a SQL right outer join;
          preserve key order.
        * outer: use union of keys from both frames, similar to a SQL full outer
          join; sort keys lexicographically.
        * inner: use intersection of keys from both frames, similar to a SQL inner
          join; preserve the order of the left keys.
        * cross: creates the cartesian product from both frames, preserves the order
          of the left keys.
    on : label or list
        Column or index level names to join on. These must be found in both
        DataFrames. If `on` is None and not merging on indexes then this defaults
        to the intersection of the columns in both DataFrames.
    left_on : label or list, or array-like
        Column or index level names to join on in the left DataFrame. Can also
        be an array or list of arrays of the length of the left DataFrame.
        These arrays are treated as if they are columns.
    right_on : label or list, or array-like
        Column or index level names to join on in the right DataFrame. Can also
        be an array or list of arrays of the length of the right DataFrame.
        These arrays are treated as if they are columns.
    left_index : bool, default False
        Use the index from the left DataFrame as the join key(s). If it is a
        MultiIndex, the number of keys in the other DataFrame (either the index
        or a number of columns) must match the number of levels.
    right_index : bool, default False
        Use the index from the right DataFrame as the join key. Same caveats as
        left_index.
    sort : bool, default False
        Sort the join keys lexicographically in the result DataFrame. If False,
        the order of the join keys depends on the join type (how keyword).
    suffixes : list-like, default is ("_x", "_y")
        A length-2 sequence where each element is optionally a string
        indicating the suffix to add to overlapping column names in
        `left` and `right` respectively. Pass a value of `None` instead
        of a string to indicate that the column name from `left` or
        `right` should be left as-is, with no suffix. At least one of the
        values must not be None.
    copy : bool, default True
        If False, avoid copy if possible.

        .. note::
            The `copy` keyword will change behavior in pandas 3.0.
            `Copy-on-Write
            &lt;https://pandas.pydata.org/docs/dev/user_guide/copy_on_write.html&gt;`__
            will be enabled by default, which means that all methods with a
            `copy` keyword will use a lazy copy mechanism to defer the copy and
            ignore the `copy` keyword. The `copy` keyword will be removed in a
            future version of pandas.

            You can already get the future behavior and improvements through
            enabling copy on write ``pd.options.mode.copy_on_write = True``
    indicator : bool or str, default False
        If True, adds a column to the output DataFrame called "_merge" with
        information on the source of each row. The column can be given a different
        name by providing a string argument. The column will have a Categorical
        type with the value of "left_only" for observations whose merge key only
        appears in the left DataFrame, "right_only" for observations
        whose merge key only appears in the right DataFrame, and "both"
        if the observation's merge key is found in both DataFrames.

    validate : str, optional
        If specified, checks if merge is of specified type.

        * "one_to_one" or "1:1": check if merge keys are unique in both
          left and right datasets.
        * "one_to_many" or "1:m": check if merge keys are unique in left
          dataset.
        * "many_to_one" or "m:1": check if merge keys are unique in right
          dataset.
        * "many_to_many" or "m:m": allowed, but does not result in checks.

    Returns
    -------
    DataFrame
        A DataFrame of the two merged objects.

    See Also
    --------
    merge_ordered : Merge with optional filling/interpolation.
    merge_asof : Merge on nearest keys.
    DataFrame.join : Similar method using indices.

    Examples
    --------
    &gt;&gt;&gt; df1 = pd.DataFrame({'lkey': ['foo', 'bar', 'baz', 'foo'],
    ...                     'value': [1, 2, 3, 5]})
    &gt;&gt;&gt; df2 = pd.DataFrame({'rkey': ['foo', 'bar', 'baz', 'foo'],
    ...                     'value': [5, 6, 7, 8]})
    &gt;&gt;&gt; df1
        lkey value
    0   foo      1
    1   bar      2
    2   baz      3
    3   foo      5
    &gt;&gt;&gt; df2
        rkey value
    0   foo      5
    1   bar      6
    2   baz      7
    3   foo      8

    Merge df1 and df2 on the lkey and rkey columns. The value columns have
    the default suffixes, _x and _y, appended.

    &gt;&gt;&gt; df1.merge(df2, left_on='lkey', right_on='rkey')
      lkey  value_x rkey  value_y
    0  foo        1  foo        5
    1  foo        1  foo        8
    2  bar        2  bar        6
    3  baz        3  baz        7
    4  foo        5  foo        5
    5  foo        5  foo        8

    Merge DataFrames df1 and df2 with specified left and right suffixes
    appended to any overlapping columns.

    &gt;&gt;&gt; df1.merge(df2, left_on='lkey', right_on='rkey',
    ...           suffixes=('_left', '_right'))
      lkey  value_left rkey  value_right
    0  foo           1  foo            5
    1  foo           1  foo            8
    2  bar           2  bar            6
    3  baz           3  baz            7
    4  foo           5  foo            5
    5  foo           5  foo            8

    Merge DataFrames df1 and df2, but raise an exception if the DataFrames have
    any overlapping columns.

    &gt;&gt;&gt; df1.merge(df2, left_on='lkey', right_on='rkey', suffixes=(False, False))
    Traceback (most recent call last):
    ...
    ValueError: columns overlap but no suffix specified:
        Index(['value'], dtype='object')

    &gt;&gt;&gt; df1 = pd.DataFrame({'a': ['foo', 'bar'], 'b': [1, 2]})
    &gt;&gt;&gt; df2 = pd.DataFrame({'a': ['foo', 'baz'], 'c': [3, 4]})
    &gt;&gt;&gt; df1
          a  b
    0   foo  1
    1   bar  2
    &gt;&gt;&gt; df2
          a  c
    0   foo  3
    1   baz  4

    &gt;&gt;&gt; df1.merge(df2, how='inner', on='a')
          a  b  c
    0   foo  1  3

    &gt;&gt;&gt; df1.merge(df2, how='left', on='a')
          a  b  c
    0   foo  1  3.0
    1   bar  2  NaN

    &gt;&gt;&gt; df1 = pd.DataFrame({'left': ['foo', 'bar']})
    &gt;&gt;&gt; df2 = pd.DataFrame({'right': [7, 8]})
    &gt;&gt;&gt; df1
        left
    0   foo
    1   bar
    &gt;&gt;&gt; df2
        right
    0   7
    1   8

    &gt;&gt;&gt; df1.merge(df2, how='cross')
       left  right
    0   foo      7
    1   foo      8
    2   bar      7
    3   bar      8
</code></pre>
</div>
</div>
<p>其典型语法：</p>
<p><code>pd.merge(left, right, on=None, how='inner')</code></p>
<ul>
<li><code>left</code>, <code>right</code>: 要合并的两个DataFrame。</li>
<li><code>on</code>: 用于合并的键，可以是列名或列名列表。如果未指定，merge 会自动寻找两个DataFrame中同名的列作为键。如果合并的键不同，可以设定:
<ul>
<li><code>left_on</code>：左DataFrame合并的键；</li>
<li><code>right_on</code>：右DataFrame合并的键；</li>
<li><code>left_index</code>:使用左DataFrame的索引为合并的键；</li>
<li><code>right_index</code>：使用右DataFrame的索引为合并的键</li>
</ul></li>
<li><code>how</code>: 指定合并类型，如图 <a href="#fig-merge" class="quarto-xref">Figure&nbsp;2</a> 所示：
<ul>
<li>‘inner’（默认）：内连接，只保留两个DataFrame中键都存在的数据。</li>
<li>‘outer’: 外连接，保留所有键，缺失值用NaN填充。</li>
<li>‘left’: 左连接，保留左DataFrame的所有键，右DataFrame中没有对应键的数据用NaN填充。</li>
<li>‘right’: 右连接，保留右DataFrame的所有键，左DataFrame中没有对应键的数据用NaN填充。</li>
</ul></li>
</ul>
<div id="fig-merge" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-merge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/merge.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-merge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Merge 方法示意图
</figcaption>
</figure>
</div>
<p>PWT数据是经过购买力平价调整后的数据，假如我们还需要其他的跨国数据，如通货膨胀率、霍比增长速度等，我们就需要与其他数据集合并。</p>
<p>首先我们从世界银行数据库下载 <a href="https://data.worldbank.org/indicator/NY.GDP.DEFL.KD.ZG">Inflation, GDP deflator (annual %)</a>、<a href="https://data.worldbank.org/indicator/FM.LBL.BMNY.ZG">Broad money growth (annual %)</a>， 两个变量：</p>
<div id="f2fbafb3" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import wbgapi as wb</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># df_wb = wb.data.DataFrame(series=['NY.GDP.DEFL.KD.ZG', 'FM.LBL.BMNY.ZG'], time='2019')</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co">#df_wb.to_csv("datasets/Inf_M2.csv")</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>df_wb <span class="op">=</span> pd.read_csv(<span class="st">"datasets/Inf_M2.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>df_wb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">FM.LBL.BMNY.ZG</th>
<th data-quarto-table-cell-role="th">NY.GDP.DEFL.KD.ZG</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">economy</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ABW</td>
<td>4.398</td>
<td>6.018</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AFE</td>
<td>NaN</td>
<td>4.444</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AFG</td>
<td>5.704</td>
<td>6.521</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AFW</td>
<td>NaN</td>
<td>1.359</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AGO</td>
<td>30.114</td>
<td>19.187</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">XKX</td>
<td>12.571</td>
<td>0.963</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">YEM</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZAF</td>
<td>6.110</td>
<td>4.614</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ZMB</td>
<td>12.545</td>
<td>7.633</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZWE</td>
<td>249.835</td>
<td>225.395</td>
</tr>
</tbody>
</table>

<p>266 rows × 2 columns</p>
</div>
</div>
</div>
<p>我们发现数据集索引变量<code>economy</code>使用的同样是ISO国家代码，作为练习，我们希望获得国家名称、收入水平等级、首都等信息，可以使用<code>wb.economy.DataFrame()</code>获取一个包含所有国家/地区信息的数据框：</p>
<div id="f542efd3" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>country_info <span class="op">=</span> wb.economy.DataFrame(skipAggs<span class="op">=</span><span class="va">True</span>)[[<span class="st">'name'</span>, <span class="st">'incomeLevel'</span>,<span class="st">'capitalCity'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>现在我们有3个数据集，<code>pwt2019</code>、<code>df_wb</code>、<code>country_info</code>，要合并在一起，我们可以：</p>
<ul>
<li><code>df_wb</code>和<code>country_info</code>数据集索引相同，根据索引首先进行合并；</li>
<li>合并后的数据有变量<code>name</code>，表示国家名称，然后用<strong>变量</strong>作为合并的键进行合并</li>
</ul>
<div id="bd5ca212" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>merged_df1 <span class="op">=</span>pd.merge(pwt2019_sub, </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>            pd.merge(df_wb, country_info, left_index<span class="op">=</span><span class="va">True</span>, right_index<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>            left_on<span class="op">=</span><span class="st">"country"</span>, right_on<span class="op">=</span><span class="st">"name"</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>merged_df1.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>(156, 13)</code></pre>
</div>
</div>
<p>默认的是 <code>how='inner'</code>，不能合并的数据将被删除。我们发现，合并后观测值有156个，这是因为两个数据集中国家名称并不完全一致。推荐使用索引进行合并:</p>
<div id="d9d89239" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>merged_df2 <span class="op">=</span> pd.merge(pwt2019_sub,</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>            pd.merge(df_wb, country_info, left_index<span class="op">=</span><span class="va">True</span>, right_index<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>            left_index<span class="op">=</span><span class="va">True</span>, right_index<span class="op">=</span><span class="va">True</span>, how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>merged_df2.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>(183, 13)</code></pre>
</div>
</div>
</section>
</section>
<section id="多级索引" class="level2">
<h2 class="anchored" data-anchor-id="多级索引">多级索引</h2>
<p>数据集Penn World Table是一个面板数据，“国家-年”对应一个观测值，每个国家都有多个观测值。可以利用Pandas的多级索引功能，详见Pandas文档<a href="https://pandas.pydata.org/docs/dev/user_guide/advanced.html#">MultiIndex / advanced indexing</a>。</p>
<div id="4771c957" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>pwt <span class="op">=</span> pd.read_excel(io <span class="op">=</span> <span class="st">"datasets/pwt1001.xlsx"</span>,</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                header<span class="op">=</span><span class="dv">0</span>,                </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>                sheet_name<span class="op">=</span><span class="st">"Data"</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>pwt.set_index([<span class="st">'countrycode'</span>,<span class="st">'year'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>pwt.tail()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">cda</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">ZWE</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>40141.617</td>
<td>39798.645</td>
<td>13.815</td>
<td>6.394</td>
<td>NaN</td>
<td>2.585</td>
<td>44249.355</td>
<td>47325.461</td>
<td>...</td>
<td>0.140</td>
<td>-0.288</td>
<td>-0.052</td>
<td>0.479</td>
<td>0.651</td>
<td>0.541</td>
<td>0.617</td>
<td>0.533</td>
<td>0.426</td>
<td>1.778</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2016</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>41875.203</td>
<td>40963.191</td>
<td>14.030</td>
<td>6.504</td>
<td>NaN</td>
<td>2.616</td>
<td>43291.566</td>
<td>46404.160</td>
<td>...</td>
<td>0.132</td>
<td>-0.251</td>
<td>-0.016</td>
<td>0.471</td>
<td>0.651</td>
<td>0.540</td>
<td>0.620</td>
<td>0.520</td>
<td>0.419</td>
<td>1.729</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2017</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>44672.176</td>
<td>44316.742</td>
<td>14.237</td>
<td>6.612</td>
<td>NaN</td>
<td>2.648</td>
<td>46113.945</td>
<td>49457.570</td>
<td>...</td>
<td>0.127</td>
<td>-0.203</td>
<td>-0.040</td>
<td>0.474</td>
<td>0.640</td>
<td>0.520</td>
<td>0.620</td>
<td>0.552</td>
<td>0.419</td>
<td>1.756</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>44325.109</td>
<td>43420.898</td>
<td>14.439</td>
<td>6.715</td>
<td>NaN</td>
<td>2.681</td>
<td>46198.441</td>
<td>49665.387</td>
<td>...</td>
<td>0.144</td>
<td>-0.264</td>
<td>-0.021</td>
<td>0.544</td>
<td>0.655</td>
<td>0.530</td>
<td>0.641</td>
<td>0.562</td>
<td>0.427</td>
<td>1.830</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2019</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>42296.062</td>
<td>40826.570</td>
<td>14.645</td>
<td>6.831</td>
<td>NaN</td>
<td>2.713</td>
<td>43961.840</td>
<td>47128.785</td>
<td>...</td>
<td>0.214</td>
<td>-0.271</td>
<td>-0.090</td>
<td>0.495</td>
<td>0.652</td>
<td>0.501</td>
<td>0.488</td>
<td>0.430</td>
<td>0.420</td>
<td>1.581</td>
</tr>
</tbody>
</table>

<p>5 rows × 50 columns</p>
</div>
</div>
</div>
<p>多重索引是由多个级别的标签构成的，在Pandas内部以元组的形式表示和管理：</p>
<div id="4917dd73" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>pwt.index[:<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>MultiIndex([('ABW', 1950),
            ('ABW', 1951),
            ('ABW', 1952)],
           names=['countrycode', 'year'])</code></pre>
</div>
</div>
<section id="选择数据" class="level3">
<h3 class="anchored" data-anchor-id="选择数据">选择数据</h3>
<p>同样，我们可以使用<code>.loc()</code>标签（labels）方法选择需要的数据，例如：</p>
<div id="dd019ca7" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>pwt.loc[[<span class="st">'CHN'</span>, <span class="st">'USA'</span>], [<span class="st">'rgdpe'</span>,<span class="st">'pop'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">pop</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">CHN</td>
<td data-quarto-table-cell-role="th">1950</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1951</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1952</td>
<td>554906.438</td>
<td>579.577</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1953</td>
<td>626291.125</td>
<td>589.317</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1954</td>
<td>584967.125</td>
<td>599.943</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">USA</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>18905122.000</td>
<td>320.878</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2016</td>
<td>19285252.000</td>
<td>323.016</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2017</td>
<td>19754754.000</td>
<td>325.085</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018</td>
<td>20369440.000</td>
<td>327.096</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2019</td>
<td>20860506.000</td>
<td>329.065</td>
</tr>
</tbody>
</table>

<p>140 rows × 2 columns</p>
</div>
</div>
</div>
<p>如果需要选择某一年的截面数据，由于有多级索引，可以用一个元组来为每一级索引提供一个选择器：</p>
<div id="f448a6dd" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>pwt.loc[(<span class="bu">slice</span>(<span class="va">None</span>), <span class="dv">2015</span>), :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">cda</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ABW</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>3959.593</td>
<td>3921.183</td>
<td>0.104</td>
<td>0.047</td>
<td>NaN</td>
<td>NaN</td>
<td>3029.996</td>
<td>3972.749</td>
<td>...</td>
<td>0.923</td>
<td>-0.926</td>
<td>0.000</td>
<td>0.795</td>
<td>0.668</td>
<td>0.661</td>
<td>0.586</td>
<td>0.590</td>
<td>0.586</td>
<td>0.514</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AGO</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>Angola</td>
<td>Kwanza</td>
<td>216207.094</td>
<td>224712.609</td>
<td>27.884</td>
<td>14.529</td>
<td>NaN</td>
<td>1.453</td>
<td>153591.031</td>
<td>222846.484</td>
<td>...</td>
<td>0.304</td>
<td>-0.157</td>
<td>-0.140</td>
<td>0.574</td>
<td>0.574</td>
<td>0.407</td>
<td>0.498</td>
<td>0.613</td>
<td>0.352</td>
<td>0.545</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AIA</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>Anguilla</td>
<td>East Caribbean Dollar</td>
<td>408.109</td>
<td>249.571</td>
<td>0.014</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>387.717</td>
<td>490.294</td>
<td>...</td>
<td>1.337</td>
<td>-2.373</td>
<td>0.000</td>
<td>0.860</td>
<td>0.812</td>
<td>0.650</td>
<td>0.645</td>
<td>0.483</td>
<td>0.628</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ALB</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>Albania</td>
<td>Lek</td>
<td>32037.936</td>
<td>33659.422</td>
<td>2.891</td>
<td>0.926</td>
<td>NaN</td>
<td>2.938</td>
<td>30027.896</td>
<td>37551.594</td>
<td>...</td>
<td>0.099</td>
<td>-0.254</td>
<td>0.034</td>
<td>0.393</td>
<td>0.391</td>
<td>0.191</td>
<td>0.584</td>
<td>0.507</td>
<td>0.260</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ARE</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>United Arab Emirates</td>
<td>UAE Dirham</td>
<td>632701.188</td>
<td>693186.188</td>
<td>9.263</td>
<td>5.631</td>
<td>NaN</td>
<td>2.734</td>
<td>247580.266</td>
<td>465946.500</td>
<td>...</td>
<td>0.770</td>
<td>-0.666</td>
<td>0.228</td>
<td>0.721</td>
<td>0.420</td>
<td>0.621</td>
<td>0.559</td>
<td>0.618</td>
<td>0.279</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">VNM</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>Viet Nam</td>
<td>Dong</td>
<td>561821.188</td>
<td>572777.500</td>
<td>92.677</td>
<td>52.840</td>
<td>2191.370</td>
<td>2.669</td>
<td>443934.562</td>
<td>574238.562</td>
<td>...</td>
<td>0.442</td>
<td>-0.439</td>
<td>-0.000</td>
<td>0.337</td>
<td>0.410</td>
<td>0.227</td>
<td>0.636</td>
<td>0.655</td>
<td>0.257</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">YEM</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>Yemen</td>
<td>Yemeni Rial</td>
<td>62905.148</td>
<td>67143.297</td>
<td>26.498</td>
<td>4.775</td>
<td>NaN</td>
<td>1.627</td>
<td>69915.164</td>
<td>75506.180</td>
<td>...</td>
<td>0.015</td>
<td>-0.168</td>
<td>0.011</td>
<td>0.508</td>
<td>0.599</td>
<td>0.218</td>
<td>0.531</td>
<td>0.591</td>
<td>0.468</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZAF</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>South Africa</td>
<td>Rand</td>
<td>717051.875</td>
<td>716283.250</td>
<td>55.386</td>
<td>17.784</td>
<td>NaN</td>
<td>2.719</td>
<td>578029.562</td>
<td>721576.188</td>
<td>...</td>
<td>0.178</td>
<td>-0.197</td>
<td>0.005</td>
<td>0.438</td>
<td>0.463</td>
<td>0.449</td>
<td>0.635</td>
<td>0.610</td>
<td>0.295</td>
<td>0.542</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ZMB</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>Zambia</td>
<td>Kwacha</td>
<td>51722.648</td>
<td>52037.516</td>
<td>15.879</td>
<td>4.598</td>
<td>NaN</td>
<td>2.502</td>
<td>37000.527</td>
<td>57027.535</td>
<td>...</td>
<td>0.200</td>
<td>-0.262</td>
<td>-0.039</td>
<td>0.376</td>
<td>0.454</td>
<td>0.375</td>
<td>0.636</td>
<td>0.584</td>
<td>0.277</td>
<td>0.440</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZWE</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>40141.617</td>
<td>39798.645</td>
<td>13.815</td>
<td>6.394</td>
<td>NaN</td>
<td>2.585</td>
<td>44249.355</td>
<td>47325.461</td>
<td>...</td>
<td>0.140</td>
<td>-0.288</td>
<td>-0.052</td>
<td>0.479</td>
<td>0.651</td>
<td>0.541</td>
<td>0.617</td>
<td>0.533</td>
<td>0.426</td>
<td>1.778</td>
</tr>
</tbody>
</table>

<p>183 rows × 50 columns</p>
</div>
</div>
</div>
<p>注意， - 这里使用了 <code>slice(None)</code>，是 Python 中表示**“所有”的一种方式，表示：“在第一级索引（例如，国家代码）上，选择所有标签。” - <code>2015</code>表示：“在第二级索引（例如，年份）上，只选择标签为 2015 的行。” - 如果想选择多年数据可以列表形式，如[2001,2015]。</p>
<p>如果是选择1992年以后的数据，可以在第二级索引上同样应用 <code>slice()</code>： 年之后的数据</p>
<div id="3467d683" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>pwt.loc[(<span class="bu">slice</span>(<span class="va">None</span>), <span class="bu">slice</span>(<span class="dv">1992</span>, <span class="va">None</span>)), :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">cda</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">ABW</td>
<td data-quarto-table-cell-role="th">1992</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>2944.516</td>
<td>3370.538</td>
<td>0.068</td>
<td>0.031</td>
<td>NaN</td>
<td>NaN</td>
<td>1722.105</td>
<td>2955.296</td>
<td>...</td>
<td>0.778</td>
<td>-0.478</td>
<td>-0.035</td>
<td>0.413</td>
<td>0.260</td>
<td>0.432</td>
<td>0.320</td>
<td>0.483</td>
<td>0.269</td>
<td>0.904</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1993</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>3131.371</td>
<td>3698.532</td>
<td>0.073</td>
<td>0.033</td>
<td>NaN</td>
<td>NaN</td>
<td>1860.498</td>
<td>3167.873</td>
<td>...</td>
<td>0.825</td>
<td>-0.602</td>
<td>-0.035</td>
<td>0.437</td>
<td>0.273</td>
<td>0.471</td>
<td>0.355</td>
<td>0.455</td>
<td>0.281</td>
<td>0.898</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1994</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>3537.953</td>
<td>4172.824</td>
<td>0.077</td>
<td>0.035</td>
<td>NaN</td>
<td>NaN</td>
<td>2015.999</td>
<td>3393.727</td>
<td>...</td>
<td>0.764</td>
<td>-0.501</td>
<td>-0.040</td>
<td>0.448</td>
<td>0.297</td>
<td>0.428</td>
<td>0.377</td>
<td>0.508</td>
<td>0.310</td>
<td>0.939</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1995</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>3412.875</td>
<td>4184.156</td>
<td>0.080</td>
<td>0.037</td>
<td>NaN</td>
<td>NaN</td>
<td>2034.535</td>
<td>3435.051</td>
<td>...</td>
<td>0.766</td>
<td>-0.543</td>
<td>-0.031</td>
<td>0.452</td>
<td>0.304</td>
<td>0.525</td>
<td>0.405</td>
<td>0.547</td>
<td>0.283</td>
<td>0.821</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1996</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>3428.601</td>
<td>3977.093</td>
<td>0.083</td>
<td>0.038</td>
<td>NaN</td>
<td>NaN</td>
<td>2167.171</td>
<td>3444.941</td>
<td>...</td>
<td>0.840</td>
<td>-0.669</td>
<td>-0.034</td>
<td>0.462</td>
<td>0.318</td>
<td>0.559</td>
<td>0.419</td>
<td>0.507</td>
<td>0.291</td>
<td>0.804</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">ZWE</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>40141.617</td>
<td>39798.645</td>
<td>13.815</td>
<td>6.394</td>
<td>NaN</td>
<td>2.585</td>
<td>44249.355</td>
<td>47325.461</td>
<td>...</td>
<td>0.140</td>
<td>-0.288</td>
<td>-0.052</td>
<td>0.479</td>
<td>0.651</td>
<td>0.541</td>
<td>0.617</td>
<td>0.533</td>
<td>0.426</td>
<td>1.778</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2016</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>41875.203</td>
<td>40963.191</td>
<td>14.030</td>
<td>6.504</td>
<td>NaN</td>
<td>2.616</td>
<td>43291.566</td>
<td>46404.160</td>
<td>...</td>
<td>0.132</td>
<td>-0.251</td>
<td>-0.016</td>
<td>0.471</td>
<td>0.651</td>
<td>0.540</td>
<td>0.620</td>
<td>0.520</td>
<td>0.419</td>
<td>1.729</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2017</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>44672.176</td>
<td>44316.742</td>
<td>14.237</td>
<td>6.612</td>
<td>NaN</td>
<td>2.648</td>
<td>46113.945</td>
<td>49457.570</td>
<td>...</td>
<td>0.127</td>
<td>-0.203</td>
<td>-0.040</td>
<td>0.474</td>
<td>0.640</td>
<td>0.520</td>
<td>0.620</td>
<td>0.552</td>
<td>0.419</td>
<td>1.756</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>44325.109</td>
<td>43420.898</td>
<td>14.439</td>
<td>6.715</td>
<td>NaN</td>
<td>2.681</td>
<td>46198.441</td>
<td>49665.387</td>
<td>...</td>
<td>0.144</td>
<td>-0.264</td>
<td>-0.021</td>
<td>0.544</td>
<td>0.655</td>
<td>0.530</td>
<td>0.641</td>
<td>0.562</td>
<td>0.427</td>
<td>1.830</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2019</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>42296.062</td>
<td>40826.570</td>
<td>14.645</td>
<td>6.831</td>
<td>NaN</td>
<td>2.713</td>
<td>43961.840</td>
<td>47128.785</td>
<td>...</td>
<td>0.214</td>
<td>-0.271</td>
<td>-0.090</td>
<td>0.495</td>
<td>0.652</td>
<td>0.501</td>
<td>0.488</td>
<td>0.430</td>
<td>0.420</td>
<td>1.581</td>
</tr>
</tbody>
</table>

<p>5124 rows × 50 columns</p>
</div>
</div>
</div>
<p>上面的例子使用<code>slice</code>函数不是那么直观，也可以使用<code>df.index.get_level_values('year')</code>提取索引<code>year</code>的值，形成一个序列（可以另存为一个变量），然后利用条件表达式生成一个布尔序列，对数据框进行筛选：</p>
<div id="b948a07f" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>sec_index <span class="op">=</span> pwt.index.get_level_values(<span class="st">'year'</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>pwt[sec_index <span class="op">&gt;</span> <span class="dv">1992</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">cda</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">ABW</td>
<td data-quarto-table-cell-role="th">1993</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>3131.371</td>
<td>3698.532</td>
<td>0.073</td>
<td>0.033</td>
<td>NaN</td>
<td>NaN</td>
<td>1860.498</td>
<td>3167.873</td>
<td>...</td>
<td>0.825</td>
<td>-0.602</td>
<td>-0.035</td>
<td>0.437</td>
<td>0.273</td>
<td>0.471</td>
<td>0.355</td>
<td>0.455</td>
<td>0.281</td>
<td>0.898</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1994</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>3537.953</td>
<td>4172.824</td>
<td>0.077</td>
<td>0.035</td>
<td>NaN</td>
<td>NaN</td>
<td>2015.999</td>
<td>3393.727</td>
<td>...</td>
<td>0.764</td>
<td>-0.501</td>
<td>-0.040</td>
<td>0.448</td>
<td>0.297</td>
<td>0.428</td>
<td>0.377</td>
<td>0.508</td>
<td>0.310</td>
<td>0.939</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1995</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>3412.875</td>
<td>4184.156</td>
<td>0.080</td>
<td>0.037</td>
<td>NaN</td>
<td>NaN</td>
<td>2034.535</td>
<td>3435.051</td>
<td>...</td>
<td>0.766</td>
<td>-0.543</td>
<td>-0.031</td>
<td>0.452</td>
<td>0.304</td>
<td>0.525</td>
<td>0.405</td>
<td>0.547</td>
<td>0.283</td>
<td>0.821</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1996</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>3428.601</td>
<td>3977.093</td>
<td>0.083</td>
<td>0.038</td>
<td>NaN</td>
<td>NaN</td>
<td>2167.171</td>
<td>3444.941</td>
<td>...</td>
<td>0.840</td>
<td>-0.669</td>
<td>-0.034</td>
<td>0.462</td>
<td>0.318</td>
<td>0.559</td>
<td>0.419</td>
<td>0.507</td>
<td>0.291</td>
<td>0.804</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1997</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>3718.441</td>
<td>4282.010</td>
<td>0.085</td>
<td>0.039</td>
<td>NaN</td>
<td>NaN</td>
<td>2264.614</td>
<td>3740.266</td>
<td>...</td>
<td>0.849</td>
<td>-0.724</td>
<td>-0.018</td>
<td>0.481</td>
<td>0.325</td>
<td>0.564</td>
<td>0.417</td>
<td>0.481</td>
<td>0.299</td>
<td>0.821</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">ZWE</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>40141.617</td>
<td>39798.645</td>
<td>13.815</td>
<td>6.394</td>
<td>NaN</td>
<td>2.585</td>
<td>44249.355</td>
<td>47325.461</td>
<td>...</td>
<td>0.140</td>
<td>-0.288</td>
<td>-0.052</td>
<td>0.479</td>
<td>0.651</td>
<td>0.541</td>
<td>0.617</td>
<td>0.533</td>
<td>0.426</td>
<td>1.778</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2016</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>41875.203</td>
<td>40963.191</td>
<td>14.030</td>
<td>6.504</td>
<td>NaN</td>
<td>2.616</td>
<td>43291.566</td>
<td>46404.160</td>
<td>...</td>
<td>0.132</td>
<td>-0.251</td>
<td>-0.016</td>
<td>0.471</td>
<td>0.651</td>
<td>0.540</td>
<td>0.620</td>
<td>0.520</td>
<td>0.419</td>
<td>1.729</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2017</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>44672.176</td>
<td>44316.742</td>
<td>14.237</td>
<td>6.612</td>
<td>NaN</td>
<td>2.648</td>
<td>46113.945</td>
<td>49457.570</td>
<td>...</td>
<td>0.127</td>
<td>-0.203</td>
<td>-0.040</td>
<td>0.474</td>
<td>0.640</td>
<td>0.520</td>
<td>0.620</td>
<td>0.552</td>
<td>0.419</td>
<td>1.756</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>44325.109</td>
<td>43420.898</td>
<td>14.439</td>
<td>6.715</td>
<td>NaN</td>
<td>2.681</td>
<td>46198.441</td>
<td>49665.387</td>
<td>...</td>
<td>0.144</td>
<td>-0.264</td>
<td>-0.021</td>
<td>0.544</td>
<td>0.655</td>
<td>0.530</td>
<td>0.641</td>
<td>0.562</td>
<td>0.427</td>
<td>1.830</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2019</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>42296.062</td>
<td>40826.570</td>
<td>14.645</td>
<td>6.831</td>
<td>NaN</td>
<td>2.713</td>
<td>43961.840</td>
<td>47128.785</td>
<td>...</td>
<td>0.214</td>
<td>-0.271</td>
<td>-0.090</td>
<td>0.495</td>
<td>0.652</td>
<td>0.501</td>
<td>0.488</td>
<td>0.430</td>
<td>0.420</td>
<td>1.581</td>
</tr>
</tbody>
</table>

<p>4941 rows × 50 columns</p>
</div>
</div>
</div>
<p>当然，可以同时选择指定的变量和年份，例如：</p>
<div id="360665d8" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>pwt.loc[(<span class="bu">slice</span>(<span class="va">None</span>), [<span class="dv">2016</span>,<span class="dv">2019</span>]), [<span class="st">'rgdpe'</span>,<span class="st">'rgdpo'</span>]]</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>pwt.loc[(([<span class="st">"CHN"</span>, <span class="st">"USA"</span>], [<span class="dv">2016</span>,<span class="dv">2019</span>])), [<span class="st">'rgdpe'</span>,<span class="st">'rgdpo'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">CHN</td>
<td data-quarto-table-cell-role="th">2016</td>
<td>18611202.000</td>
<td>18591710.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2019</td>
<td>20056066.000</td>
<td>20257660.000</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">USA</td>
<td data-quarto-table-cell-role="th">2016</td>
<td>19285252.000</td>
<td>19095196.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2019</td>
<td>20860506.000</td>
<td>20595844.000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="按索引排序" class="level3">
<h3 class="anchored" data-anchor-id="按索引排序">按索引排序</h3>
<p>除了通常的排序以外，由于有了二级索引，如果按索引排序，两级索引变量是同时排序的：</p>
<div id="67a0db13" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>pwt.sort_index(ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">cda</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">ZWE</td>
<td data-quarto-table-cell-role="th">2019</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>42296.062</td>
<td>40826.570</td>
<td>14.645</td>
<td>6.831</td>
<td>NaN</td>
<td>2.713</td>
<td>43961.840</td>
<td>47128.785</td>
<td>...</td>
<td>0.214</td>
<td>-0.271</td>
<td>-0.090</td>
<td>0.495</td>
<td>0.652</td>
<td>0.501</td>
<td>0.488</td>
<td>0.430</td>
<td>0.420</td>
<td>1.581</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>44325.109</td>
<td>43420.898</td>
<td>14.439</td>
<td>6.715</td>
<td>NaN</td>
<td>2.681</td>
<td>46198.441</td>
<td>49665.387</td>
<td>...</td>
<td>0.144</td>
<td>-0.264</td>
<td>-0.021</td>
<td>0.544</td>
<td>0.655</td>
<td>0.530</td>
<td>0.641</td>
<td>0.562</td>
<td>0.427</td>
<td>1.830</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2017</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>44672.176</td>
<td>44316.742</td>
<td>14.237</td>
<td>6.612</td>
<td>NaN</td>
<td>2.648</td>
<td>46113.945</td>
<td>49457.570</td>
<td>...</td>
<td>0.127</td>
<td>-0.203</td>
<td>-0.040</td>
<td>0.474</td>
<td>0.640</td>
<td>0.520</td>
<td>0.620</td>
<td>0.552</td>
<td>0.419</td>
<td>1.756</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2016</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>41875.203</td>
<td>40963.191</td>
<td>14.030</td>
<td>6.504</td>
<td>NaN</td>
<td>2.616</td>
<td>43291.566</td>
<td>46404.160</td>
<td>...</td>
<td>0.132</td>
<td>-0.251</td>
<td>-0.016</td>
<td>0.471</td>
<td>0.651</td>
<td>0.540</td>
<td>0.620</td>
<td>0.520</td>
<td>0.419</td>
<td>1.729</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2015</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>40141.617</td>
<td>39798.645</td>
<td>13.815</td>
<td>6.394</td>
<td>NaN</td>
<td>2.585</td>
<td>44249.355</td>
<td>47325.461</td>
<td>...</td>
<td>0.140</td>
<td>-0.288</td>
<td>-0.052</td>
<td>0.479</td>
<td>0.651</td>
<td>0.541</td>
<td>0.617</td>
<td>0.533</td>
<td>0.426</td>
<td>1.778</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">ABW</td>
<td data-quarto-table-cell-role="th">1954</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1953</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1952</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1951</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1950</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>12810 rows × 50 columns</p>
</div>
</div>
</div>
<p>可以对两级索引以列表的形式分别设定排序的顺序。例如，先将国家代码按字母升序，然后将年降序：</p>
<div id="6eea6630" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>pwt.sort_index(ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">False</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">cda</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">ABW</td>
<td data-quarto-table-cell-role="th">2019</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>3921.261</td>
<td>3467.300</td>
<td>0.106</td>
<td>0.048</td>
<td>NaN</td>
<td>NaN</td>
<td>3023.695</td>
<td>3877.660</td>
<td>...</td>
<td>0.973</td>
<td>-1.092</td>
<td>0.000</td>
<td>0.883</td>
<td>0.816</td>
<td>0.744</td>
<td>0.707</td>
<td>0.623</td>
<td>0.805</td>
<td>0.648</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>3927.567</td>
<td>3444.659</td>
<td>0.106</td>
<td>0.047</td>
<td>NaN</td>
<td>NaN</td>
<td>3040.981</td>
<td>3903.105</td>
<td>...</td>
<td>1.016</td>
<td>-1.142</td>
<td>0.000</td>
<td>0.857</td>
<td>0.790</td>
<td>0.723</td>
<td>0.661</td>
<td>0.584</td>
<td>0.789</td>
<td>0.642</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2017</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>3979.910</td>
<td>3062.581</td>
<td>0.105</td>
<td>0.047</td>
<td>NaN</td>
<td>NaN</td>
<td>3044.066</td>
<td>3912.318</td>
<td>...</td>
<td>1.118</td>
<td>-1.395</td>
<td>-0.000</td>
<td>0.809</td>
<td>0.732</td>
<td>0.682</td>
<td>0.655</td>
<td>0.512</td>
<td>0.740</td>
<td>0.649</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2016</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>3953.522</td>
<td>3320.977</td>
<td>0.105</td>
<td>0.047</td>
<td>NaN</td>
<td>NaN</td>
<td>3025.954</td>
<td>3915.882</td>
<td>...</td>
<td>1.028</td>
<td>-1.184</td>
<td>0.000</td>
<td>0.798</td>
<td>0.713</td>
<td>0.668</td>
<td>0.607</td>
<td>0.524</td>
<td>0.658</td>
<td>0.583</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2015</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>3959.593</td>
<td>3921.183</td>
<td>0.104</td>
<td>0.047</td>
<td>NaN</td>
<td>NaN</td>
<td>3029.996</td>
<td>3972.749</td>
<td>...</td>
<td>0.923</td>
<td>-0.926</td>
<td>0.000</td>
<td>0.795</td>
<td>0.668</td>
<td>0.661</td>
<td>0.586</td>
<td>0.590</td>
<td>0.586</td>
<td>0.514</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">ZWE</td>
<td data-quarto-table-cell-role="th">1954</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>6373.737</td>
<td>6277.434</td>
<td>3.172</td>
<td>1.481</td>
<td>NaN</td>
<td>1.180</td>
<td>5446.247</td>
<td>6939.839</td>
<td>...</td>
<td>0.000</td>
<td>-0.000</td>
<td>-0.118</td>
<td>0.124</td>
<td>0.119</td>
<td>0.106</td>
<td>0.093</td>
<td>0.078</td>
<td>0.102</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1953</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1952</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1951</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1950</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>12810 rows × 50 columns</p>
</div>
</div>
</div>
</section>
<section id="pd.merge" class="level3">
<h3 class="anchored" data-anchor-id="pd.merge"><code>pd.merge</code></h3>
<p>假如我们想要把国家有关信息<code>country_info</code>数据与<code>pwt</code>合并，由于后者是面板数据，需要使用参数<code>validate = "m:1"</code>。下面的例子在合并之前先将索引名称重命名保持一致，否则会报错：</p>
<div id="978f53e2" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>country_info <span class="op">=</span> country_info.rename_axis(<span class="st">'countrycode'</span>, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>pd.merge(pwt, country_info, left_index<span class="op">=</span><span class="va">True</span>, right_index<span class="op">=</span><span class="va">True</span>,validate<span class="op">=</span> <span class="st">"m:1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">cda</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">incomeLevel</th>
<th data-quarto-table-cell-role="th">capitalCity</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">ABW</td>
<td data-quarto-table-cell-role="th">1950</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Aruba</td>
<td>HIC</td>
<td>Oranjestad</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1951</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Aruba</td>
<td>HIC</td>
<td>Oranjestad</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1952</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Aruba</td>
<td>HIC</td>
<td>Oranjestad</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1953</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Aruba</td>
<td>HIC</td>
<td>Oranjestad</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1954</td>
<td>Aruba</td>
<td>Aruban Guilder</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Aruba</td>
<td>HIC</td>
<td>Oranjestad</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">ZWE</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>40141.617</td>
<td>39798.645</td>
<td>13.815</td>
<td>6.394</td>
<td>NaN</td>
<td>2.585</td>
<td>44249.355</td>
<td>47325.461</td>
<td>...</td>
<td>0.479</td>
<td>0.651</td>
<td>0.541</td>
<td>0.617</td>
<td>0.533</td>
<td>0.426</td>
<td>1.778</td>
<td>Zimbabwe</td>
<td>LMC</td>
<td>Harare</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2016</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>41875.203</td>
<td>40963.191</td>
<td>14.030</td>
<td>6.504</td>
<td>NaN</td>
<td>2.616</td>
<td>43291.566</td>
<td>46404.160</td>
<td>...</td>
<td>0.471</td>
<td>0.651</td>
<td>0.540</td>
<td>0.620</td>
<td>0.520</td>
<td>0.419</td>
<td>1.729</td>
<td>Zimbabwe</td>
<td>LMC</td>
<td>Harare</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2017</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>44672.176</td>
<td>44316.742</td>
<td>14.237</td>
<td>6.612</td>
<td>NaN</td>
<td>2.648</td>
<td>46113.945</td>
<td>49457.570</td>
<td>...</td>
<td>0.474</td>
<td>0.640</td>
<td>0.520</td>
<td>0.620</td>
<td>0.552</td>
<td>0.419</td>
<td>1.756</td>
<td>Zimbabwe</td>
<td>LMC</td>
<td>Harare</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>44325.109</td>
<td>43420.898</td>
<td>14.439</td>
<td>6.715</td>
<td>NaN</td>
<td>2.681</td>
<td>46198.441</td>
<td>49665.387</td>
<td>...</td>
<td>0.544</td>
<td>0.655</td>
<td>0.530</td>
<td>0.641</td>
<td>0.562</td>
<td>0.427</td>
<td>1.830</td>
<td>Zimbabwe</td>
<td>LMC</td>
<td>Harare</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2019</td>
<td>Zimbabwe</td>
<td>US Dollar</td>
<td>42296.062</td>
<td>40826.570</td>
<td>14.645</td>
<td>6.831</td>
<td>NaN</td>
<td>2.713</td>
<td>43961.840</td>
<td>47128.785</td>
<td>...</td>
<td>0.495</td>
<td>0.652</td>
<td>0.501</td>
<td>0.488</td>
<td>0.430</td>
<td>0.420</td>
<td>1.581</td>
<td>Zimbabwe</td>
<td>LMC</td>
<td>Harare</td>
</tr>
</tbody>
</table>

<p>12600 rows × 53 columns</p>
</div>
</div>
</div>
</section>
<section id="stack-和-unstack" class="level3">
<h3 class="anchored" data-anchor-id="stack-和-unstack"><code>stack</code> 和 <code>unstack</code></h3>
<p>数据有“长（long）”和“宽（wide）”两种组织方式，Penn World Table 是以“长”的形式保存的。有时候需要在两种数据格式之间进行转换，就需要用到<code>df.stack()</code>和<code>df.unstack()</code>函数。</p>
<p>注意，<code>df.unstack()</code>函数的参数<code>level=</code>，设置为哪一级索引，便生成为列。默认在最后一级索引上转换，即年，因此列便为年，行为国家，反之，列为国家，行为年。如下面例子所示，为了简便只保留了三个国家5年的数据：</p>
<div id="ab99f84e" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>pwt_sub <span class="op">=</span> pwt.loc[([<span class="st">"CHN"</span>, <span class="st">"KOR"</span>, <span class="st">"USA"</span>], <span class="bu">slice</span>(<span class="dv">2015</span>, <span class="va">None</span>)), [<span class="st">"rgdpe"</span>, <span class="st">"pop"</span>]]</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>pwt_sub_wide <span class="op">=</span> pwt_sub.unstack(level<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pwt_sub.unstack(level=0)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>要获得长格式的数据，使用<code>df.stack()</code>即可：</p>
<div id="791701e6" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>pwt_sub_wide.stack(future_stack<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">pop</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">CHN</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>17866282.000</td>
<td>1406.848</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2016</td>
<td>18611202.000</td>
<td>1414.049</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2017</td>
<td>19501140.000</td>
<td>1421.022</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018</td>
<td>19508708.000</td>
<td>1427.648</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2019</td>
<td>20056066.000</td>
<td>1433.784</td>
</tr>
<tr class="even">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">KOR</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>1928056.875</td>
<td>50.823</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2016</td>
<td>1999699.625</td>
<td>50.983</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2017</td>
<td>2070935.625</td>
<td>51.096</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2018</td>
<td>2102051.500</td>
<td>51.172</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2019</td>
<td>2090945.875</td>
<td>51.225</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">USA</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>18905122.000</td>
<td>320.878</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2016</td>
<td>19285252.000</td>
<td>323.016</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2017</td>
<td>19754754.000</td>
<td>325.085</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018</td>
<td>20369440.000</td>
<td>327.096</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2019</td>
<td>20860506.000</td>
<td>329.065</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>当我们从一些数据库下载数据时，常见形式为列为不同时期相同变量的值。例如，从世界银行下载人均GDP和人口数据：</p>
<div id="a63a5238" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> wbgapi <span class="im">as</span> wb</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> wb.data.DataFrame(series<span class="op">=</span>[<span class="st">'NY.GDP.PCAP.CD'</span>, <span class="st">"SP.POP.TOTL"</span>], </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>                                <span class="co">#time=range(2017,2020),</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>                                time<span class="op">=</span>[<span class="st">'YR2017'</span>,<span class="st">'YR2018'</span>,<span class="st">'YR2019'</span>],</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>                                 numericTimeKeys<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">2017</th>
<th data-quarto-table-cell-role="th">2018</th>
<th data-quarto-table-cell-role="th">2019</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">economy</th>
<th data-quarto-table-cell-role="th">series</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">ABW</td>
<td data-quarto-table-cell-role="th">NY.GDP.PCAP.CD</td>
<td>28440.052</td>
<td>30082.128</td>
<td>31096.205</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SP.POP.TOTL</td>
<td>108735.000</td>
<td>108908.000</td>
<td>109203.000</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">AFE</td>
<td data-quarto-table-cell-role="th">NY.GDP.PCAP.CD</td>
<td>1520.212</td>
<td>1538.902</td>
<td>1493.818</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">SP.POP.TOTL</td>
<td>640058741.000</td>
<td>657801085.000</td>
<td>675950189.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AFG</td>
<td data-quarto-table-cell-role="th">NY.GDP.PCAP.CD</td>
<td>525.470</td>
<td>491.337</td>
<td>496.603</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>下载的数据<code>df</code>索引是“economy - series”，每一年数据一列。我们希望序列成为列变量，时间成为索引。我们可以先对数据进行转置成宽格式的数据，然后再在国家层面堆叠，使其成为索引，再交换索引排序得到通常的情况：</p>
<div id="381bfd01" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>df.T.stack(level<span class="op">=</span><span class="dv">0</span>, future_stack<span class="op">=</span><span class="va">True</span>).swaplevel().sort_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">series</th>
<th data-quarto-table-cell-role="th">NY.GDP.PCAP.CD</th>
<th data-quarto-table-cell-role="th">SP.POP.TOTL</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">economy</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">ABW</td>
<td data-quarto-table-cell-role="th">2017</td>
<td>28440.052</td>
<td>108735.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018</td>
<td>30082.128</td>
<td>108908.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2019</td>
<td>31096.205</td>
<td>109203.000</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">AFE</td>
<td data-quarto-table-cell-role="th">2017</td>
<td>1520.212</td>
<td>640058741.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2018</td>
<td>1538.902</td>
<td>657801085.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">ZMB</td>
<td data-quarto-table-cell-role="th">2018</td>
<td>1463.900</td>
<td>17973569.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2019</td>
<td>1258.986</td>
<td>18513839.000</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">ZWE</td>
<td data-quarto-table-cell-role="th">2017</td>
<td>3448.087</td>
<td>14812482.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018</td>
<td>2271.853</td>
<td>15034452.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2019</td>
<td>1683.913</td>
<td>15271368.000</td>
</tr>
</tbody>
</table>

<p>798 rows × 2 columns</p>
</div>
</div>
</div>
<p>另外，stack不是唯一的方法，也可以使用<code>df.melt()</code>结合<code>df.pivot_table()</code>函数来实现：</p>
<div id="4b4ab3a4" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>df_reset <span class="op">=</span> df.reset_index()</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>df_long <span class="op">=</span> df_reset.melt(id_vars<span class="op">=</span>[<span class="st">'economy'</span>, <span class="st">'series'</span>], var_name<span class="op">=</span><span class="st">'year'</span>, value_name<span class="op">=</span><span class="st">'value'</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>df_long.pivot_table(index<span class="op">=</span>[<span class="st">'economy'</span>, <span class="st">'year'</span>], columns<span class="op">=</span><span class="st">'series'</span>, values<span class="op">=</span><span class="st">'value'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">series</th>
<th data-quarto-table-cell-role="th">NY.GDP.PCAP.CD</th>
<th data-quarto-table-cell-role="th">SP.POP.TOTL</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">economy</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">ABW</td>
<td data-quarto-table-cell-role="th">2017</td>
<td>28440.052</td>
<td>108735.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018</td>
<td>30082.128</td>
<td>108908.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2019</td>
<td>31096.205</td>
<td>109203.000</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">AFE</td>
<td data-quarto-table-cell-role="th">2017</td>
<td>1520.212</td>
<td>640058741.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2018</td>
<td>1538.902</td>
<td>657801085.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">ZMB</td>
<td data-quarto-table-cell-role="th">2018</td>
<td>1463.900</td>
<td>17973569.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2019</td>
<td>1258.986</td>
<td>18513839.000</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">ZWE</td>
<td data-quarto-table-cell-role="th">2017</td>
<td>3448.087</td>
<td>14812482.000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018</td>
<td>2271.853</td>
<td>15034452.000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2019</td>
<td>1683.913</td>
<td>15271368.000</td>
</tr>
</tbody>
</table>

<p>795 rows × 2 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="pandas中的分组计算groupby" class="level2">
<h2 class="anchored" data-anchor-id="pandas中的分组计算groupby">Pandas中的分组计算（<code>groupby</code>）</h2>
<p>Pandas 的分组（<code>groupby()</code>）方法按照“分割-应用-组合（split-apply-combine）”的原理，创建一个 groupby 对象，可以应用各种方法来聚合、转换或过滤数据。更多介绍参见Pandas官方文档<a href="https://pandas.pydata.org/docs/user_guide/groupby.html">Group by: split-apply-combine</a>。</p>
<p>选择合适的方法：</p>
<ul>
<li>如果你的操作只是简单的统计（如求和、平均值），优先使用聚合方法，它们通常效率最高。</li>
<li>如果需要返回与原始 DataFrame 相同长度的结果，例如进行组内标准化，使用转换方法。</li>
<li>如果需要根据组的属性来决定保留或丢弃整个组，使用过滤方法。</li>
<li>当以上方法都无法满足需求时，或者需要执行更复杂的自定义逻辑时，使用<strong>apply()</strong>方法。</li>
</ul>
<section id="聚合方法aggregation-methods" class="level4">
<h4 class="anchored" data-anchor-id="聚合方法aggregation-methods">聚合方法（Aggregation Methods）</h4>
<p>聚合方法将每个组的数据压缩成一个单一的值，是最常用的<code>groupby</code>操作，例如<code>mean()</code>,<code>sum()</code>,<code>count()</code>,<code>size()</code>,<code>min()</code>,<code>max()</code>,<code>std()</code>,<code>var()</code>,<code>median()</code>等常见的统计量，或者<code>first()</code>,<code>last()</code>,<code>nth(n)</code>等获取第一个、最好一个或第n个值：</p>
<p><strong>索引</strong></p>
<p>例如，根据索引计算世界人口，先在索引上分组，然后使用<code>.sum()</code>函数：</p>
<div id="a707464f" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>pwt.groupby(level<span class="op">=</span><span class="dv">1</span>)[<span class="st">'pop'</span>].<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>year
1950   1297.363
1951   1345.649
1952   1948.874
1953   2005.092
1954   2048.591
         ...   
2015   7254.660
2016   7336.956
2017   7418.961
2018   7500.383
2019   7580.897
Name: pop, Length: 70, dtype: float64</code></pre>
</div>
</div>
<p><code>avh</code>变量度量了“Average annual hours worked by persons engaged”,让我们分组计算平均，得到按年和按国家平均</p>
<div id="2b7918fa" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>avh <span class="op">=</span> pwt[pwt[<span class="st">'avh'</span>].notna()]</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">12</span>))</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>avh.groupby(level<span class="op">=</span><span class="dv">1</span>)[<span class="st">'avh'</span>].mean().sort_values(ascending<span class="op">=</span><span class="va">False</span>).plot(kind<span class="op">=</span><span class="st">'line'</span>, ax<span class="op">=</span>ax[<span class="dv">0</span>])</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">""</span>)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">"Average annual hours worked by persons engaged"</span>)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>avh.groupby(level<span class="op">=</span><span class="dv">0</span>)[<span class="st">'avh'</span>].mean().sort_values(ascending<span class="op">=</span><span class="va">False</span>)[:<span class="dv">25</span>].plot(kind<span class="op">=</span><span class="st">'bar'</span>, ax<span class="op">=</span>ax[<span class="dv">1</span>])</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">""</span>)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">"Average annual hours worked by persons engaged"</span>)</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="pandas_files/figure-html/cell-72-output-1.png" width="974" height="948" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>最常见的是按变量进行分组，例如，按国家名<code>country</code>分组，最后一个观测值：</p>
<div id="dd18f680" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>pwt.groupby(by<span class="op">=</span>[<span class="st">'country'</span>]).last()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">cda</th>
<th data-quarto-table-cell-role="th">cgdpe</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Albania</td>
<td>Lek</td>
<td>35890.020</td>
<td>36103.043</td>
<td>2.881</td>
<td>1.076</td>
<td>NaN</td>
<td>2.965</td>
<td>33399.168</td>
<td>40868.316</td>
<td>35808.344</td>
<td>...</td>
<td>0.127</td>
<td>-0.314</td>
<td>0.061</td>
<td>0.473</td>
<td>0.457</td>
<td>0.236</td>
<td>0.630</td>
<td>0.525</td>
<td>0.301</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Algeria</td>
<td>Algerian Dinar</td>
<td>488952.375</td>
<td>507487.562</td>
<td>43.053</td>
<td>11.273</td>
<td>NaN</td>
<td>2.384</td>
<td>365349.094</td>
<td>518958.812</td>
<td>487570.812</td>
<td>...</td>
<td>0.136</td>
<td>-0.136</td>
<td>-0.031</td>
<td>0.331</td>
<td>0.512</td>
<td>0.206</td>
<td>0.519</td>
<td>0.606</td>
<td>0.327</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Angola</td>
<td>Kwanza</td>
<td>228151.016</td>
<td>227855.719</td>
<td>31.825</td>
<td>16.645</td>
<td>NaN</td>
<td>1.482</td>
<td>155943.719</td>
<td>198750.422</td>
<td>227771.609</td>
<td>...</td>
<td>0.344</td>
<td>-0.114</td>
<td>-0.120</td>
<td>0.438</td>
<td>0.343</td>
<td>0.240</td>
<td>0.476</td>
<td>0.612</td>
<td>0.211</td>
<td>0.396</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Anguilla</td>
<td>East Caribbean Dollar</td>
<td>376.635</td>
<td>225.681</td>
<td>0.015</td>
<td>0.005</td>
<td>NaN</td>
<td>NaN</td>
<td>438.470</td>
<td>509.045</td>
<td>375.136</td>
<td>...</td>
<td>1.480</td>
<td>-2.446</td>
<td>-0.143</td>
<td>1.065</td>
<td>1.029</td>
<td>0.732</td>
<td>0.769</td>
<td>0.603</td>
<td>0.898</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Antigua and Barbuda</td>
<td>East Caribbean Dollar</td>
<td>1986.163</td>
<td>1603.854</td>
<td>0.097</td>
<td>0.038</td>
<td>NaN</td>
<td>NaN</td>
<td>1787.817</td>
<td>2415.362</td>
<td>1979.578</td>
<td>...</td>
<td>0.030</td>
<td>-0.610</td>
<td>0.099</td>
<td>0.900</td>
<td>0.951</td>
<td>0.519</td>
<td>0.767</td>
<td>0.571</td>
<td>0.668</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Venezuela (Bolivarian Republic of)</td>
<td>Bolivar Fuerte</td>
<td>7166.572</td>
<td>7160.107</td>
<td>28.516</td>
<td>11.694</td>
<td>1903.852</td>
<td>2.893</td>
<td>9266.067</td>
<td>10055.498</td>
<td>7167.786</td>
<td>...</td>
<td>0.000</td>
<td>-0.001</td>
<td>-0.403</td>
<td>18.144</td>
<td>34.445</td>
<td>14.176</td>
<td>0.581</td>
<td>0.646</td>
<td>20.695</td>
<td>12.002</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Viet Nam</td>
<td>Dong</td>
<td>750726.750</td>
<td>724123.375</td>
<td>96.462</td>
<td>50.400</td>
<td>2131.968</td>
<td>2.870</td>
<td>582677.062</td>
<td>758821.938</td>
<td>747853.750</td>
<td>...</td>
<td>0.526</td>
<td>-0.518</td>
<td>-0.057</td>
<td>0.348</td>
<td>0.399</td>
<td>0.245</td>
<td>0.696</td>
<td>0.677</td>
<td>0.250</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Yemen</td>
<td>Yemeni Rial</td>
<td>50052.934</td>
<td>51828.059</td>
<td>29.162</td>
<td>5.532</td>
<td>NaN</td>
<td>1.843</td>
<td>49266.473</td>
<td>67992.531</td>
<td>49937.043</td>
<td>...</td>
<td>0.001</td>
<td>-0.135</td>
<td>-0.173</td>
<td>0.778</td>
<td>0.239</td>
<td>0.212</td>
<td>0.633</td>
<td>0.671</td>
<td>0.175</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Zambia</td>
<td>Kwacha</td>
<td>57956.184</td>
<td>56783.715</td>
<td>17.861</td>
<td>5.225</td>
<td>NaN</td>
<td>2.687</td>
<td>38698.402</td>
<td>56536.863</td>
<td>57695.066</td>
<td>...</td>
<td>0.215</td>
<td>-0.239</td>
<td>0.028</td>
<td>0.373</td>
<td>0.482</td>
<td>0.330</td>
<td>0.574</td>
<td>0.532</td>
<td>0.295</td>
<td>0.360</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Zimbabwe</td>
<td>US Dollar</td>
<td>42296.062</td>
<td>40826.570</td>
<td>14.645</td>
<td>6.831</td>
<td>NaN</td>
<td>2.713</td>
<td>43961.840</td>
<td>47128.785</td>
<td>42325.117</td>
<td>...</td>
<td>0.214</td>
<td>-0.271</td>
<td>-0.090</td>
<td>0.495</td>
<td>0.652</td>
<td>0.501</td>
<td>0.488</td>
<td>0.430</td>
<td>0.420</td>
<td>1.581</td>
</tr>
</tbody>
</table>

<p>183 rows × 49 columns</p>
</div>
</div>
</div>
</section>
<section id="转换方法transformation-methods" class="level3">
<h3 class="anchored" data-anchor-id="转换方法transformation-methods">转换方法（Transformation Methods）</h3>
<ul>
<li><code>transform(func)</code>: 对每个组应用函数，并将结果广播回原始 DataFrame 的形状。</li>
<li><code>rank(method='average')</code>: 计算组内排名。</li>
<li><code>fillna(value)</code>: 在组内填充缺失值。</li>
</ul>
<div id="35cffcaa" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>avh.groupby(level<span class="op">=</span><span class="dv">1</span>)[<span class="st">'avh'</span>].transform(<span class="st">'mean'</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>avh.groupby(level<span class="op">=</span><span class="dv">1</span>)[<span class="st">'avh'</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>year
1950   2171.439
1951   2190.832
1952   2181.242
1953   2183.205
1954   2179.604
         ...   
2015   1865.221
2016   1871.138
2017   1858.543
2018   1854.066
2019   1849.981
Name: avh, Length: 70, dtype: float64</code></pre>
</div>
</div>
<p>注意，转换与聚合的区别,转换将生成的值与原数据观测值一样多，这里是3492个，而聚合只有70个。</p>
<p><code>.transform()</code>方法可以与<code>lambda</code>函数相结合，例如：</p>
<div id="8d50307d" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>pwt.select_dtypes(np.number).groupby(level<span class="op">=</span><span class="dv">0</span>).transform(<span class="kw">lambda</span> x: (x <span class="op">-</span> x.mean())<span class="op">/</span>x.std())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">cda</th>
<th data-quarto-table-cell-role="th">cgdpe</th>
<th data-quarto-table-cell-role="th">cgdpo</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">ABW</td>
<td data-quarto-table-cell-role="th">1950</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1951</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1952</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1953</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1954</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">ZWE</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>0.558</td>
<td>0.539</td>
<td>1.363</td>
<td>1.482</td>
<td>NaN</td>
<td>1.685</td>
<td>1.065</td>
<td>0.879</td>
<td>0.568</td>
<td>0.518</td>
<td>...</td>
<td>0.573</td>
<td>-1.555</td>
<td>-0.255</td>
<td>0.530</td>
<td>1.749</td>
<td>2.268</td>
<td>1.208</td>
<td>0.981</td>
<td>1.695</td>
<td>-0.574</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2016</td>
<td>0.654</td>
<td>0.603</td>
<td>1.423</td>
<td>1.548</td>
<td>NaN</td>
<td>1.752</td>
<td>1.007</td>
<td>0.829</td>
<td>0.664</td>
<td>0.595</td>
<td>...</td>
<td>0.495</td>
<td>-1.255</td>
<td>0.077</td>
<td>0.502</td>
<td>1.748</td>
<td>2.255</td>
<td>1.223</td>
<td>0.905</td>
<td>1.640</td>
<td>-0.603</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2017</td>
<td>0.809</td>
<td>0.787</td>
<td>1.479</td>
<td>1.612</td>
<td>NaN</td>
<td>1.821</td>
<td>1.177</td>
<td>0.994</td>
<td>0.831</td>
<td>0.783</td>
<td>...</td>
<td>0.445</td>
<td>-0.857</td>
<td>-0.143</td>
<td>0.512</td>
<td>1.690</td>
<td>2.108</td>
<td>1.223</td>
<td>1.086</td>
<td>1.634</td>
<td>-0.587</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018</td>
<td>0.790</td>
<td>0.738</td>
<td>1.535</td>
<td>1.674</td>
<td>NaN</td>
<td>1.890</td>
<td>1.182</td>
<td>1.005</td>
<td>0.812</td>
<td>0.742</td>
<td>...</td>
<td>0.614</td>
<td>-1.357</td>
<td>0.035</td>
<td>0.736</td>
<td>1.770</td>
<td>2.182</td>
<td>1.332</td>
<td>1.139</td>
<td>1.702</td>
<td>-0.543</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2019</td>
<td>0.677</td>
<td>0.595</td>
<td>1.592</td>
<td>1.744</td>
<td>NaN</td>
<td>1.961</td>
<td>1.048</td>
<td>0.868</td>
<td>0.700</td>
<td>0.607</td>
<td>...</td>
<td>1.271</td>
<td>-1.417</td>
<td>-0.607</td>
<td>0.579</td>
<td>1.755</td>
<td>1.965</td>
<td>0.558</td>
<td>0.405</td>
<td>1.644</td>
<td>-0.691</td>
</tr>
</tbody>
</table>

<p>12810 rows × 43 columns</p>
</div>
</div>
</div>
</section>
<section id="过滤方法filtration-methods" class="level3">
<h3 class="anchored" data-anchor-id="过滤方法filtration-methods">过滤方法（Filtration Methods）</h3>
<p>过滤方法会根据每个组的某个条件来排除整个组。</p>
<ul>
<li>filter(func): 根据一个返回布尔值的函数来过滤组。如果函数对一个组返回 True，则保留该组；否则，删除该组。</li>
</ul>
<div id="387b480c" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>pwt.groupby(level<span class="op">=</span><span class="dv">0</span>).<span class="bu">filter</span>(<span class="kw">lambda</span> x: x[<span class="st">'pop'</span>].mean() <span class="op">&gt;</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">currency_unit</th>
<th data-quarto-table-cell-role="th">rgdpe</th>
<th data-quarto-table-cell-role="th">rgdpo</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">emp</th>
<th data-quarto-table-cell-role="th">avh</th>
<th data-quarto-table-cell-role="th">hc</th>
<th data-quarto-table-cell-role="th">ccon</th>
<th data-quarto-table-cell-role="th">cda</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">csh_x</th>
<th data-quarto-table-cell-role="th">csh_m</th>
<th data-quarto-table-cell-role="th">csh_r</th>
<th data-quarto-table-cell-role="th">pl_c</th>
<th data-quarto-table-cell-role="th">pl_i</th>
<th data-quarto-table-cell-role="th">pl_g</th>
<th data-quarto-table-cell-role="th">pl_x</th>
<th data-quarto-table-cell-role="th">pl_m</th>
<th data-quarto-table-cell-role="th">pl_n</th>
<th data-quarto-table-cell-role="th">pl_k</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">countrycode</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">BGD</td>
<td data-quarto-table-cell-role="th">1950</td>
<td>Bangladesh</td>
<td>Taka</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1951</td>
<td>Bangladesh</td>
<td>Taka</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1952</td>
<td>Bangladesh</td>
<td>Taka</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1953</td>
<td>Bangladesh</td>
<td>Taka</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1954</td>
<td>Bangladesh</td>
<td>Taka</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">VNM</td>
<td data-quarto-table-cell-role="th">2015</td>
<td>Viet Nam</td>
<td>Dong</td>
<td>561821.188</td>
<td>572777.500</td>
<td>92.677</td>
<td>52.840</td>
<td>2191.370</td>
<td>2.669</td>
<td>443934.562</td>
<td>574238.562</td>
<td>...</td>
<td>0.442</td>
<td>-0.439</td>
<td>-0.000</td>
<td>0.337</td>
<td>0.410</td>
<td>0.227</td>
<td>0.636</td>
<td>0.655</td>
<td>0.257</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2016</td>
<td>Viet Nam</td>
<td>Dong</td>
<td>601767.562</td>
<td>596363.125</td>
<td>93.640</td>
<td>53.303</td>
<td>2169.552</td>
<td>2.716</td>
<td>473113.406</td>
<td>610603.438</td>
<td>...</td>
<td>0.463</td>
<td>-0.451</td>
<td>-0.024</td>
<td>0.338</td>
<td>0.397</td>
<td>0.237</td>
<td>0.633</td>
<td>0.643</td>
<td>0.245</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2017</td>
<td>Viet Nam</td>
<td>Dong</td>
<td>653410.812</td>
<td>647224.938</td>
<td>94.601</td>
<td>53.703</td>
<td>2131.968</td>
<td>2.765</td>
<td>507151.375</td>
<td>660755.875</td>
<td>...</td>
<td>0.516</td>
<td>-0.517</td>
<td>-0.020</td>
<td>0.341</td>
<td>0.387</td>
<td>0.240</td>
<td>0.644</td>
<td>0.637</td>
<td>0.243</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018</td>
<td>Viet Nam</td>
<td>Dong</td>
<td>705553.375</td>
<td>689643.438</td>
<td>95.546</td>
<td>54.069</td>
<td>2131.968</td>
<td>2.816</td>
<td>543525.250</td>
<td>708143.188</td>
<td>...</td>
<td>0.522</td>
<td>-0.519</td>
<td>-0.034</td>
<td>0.346</td>
<td>0.395</td>
<td>0.244</td>
<td>0.679</td>
<td>0.664</td>
<td>0.246</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2019</td>
<td>Viet Nam</td>
<td>Dong</td>
<td>750726.750</td>
<td>724123.375</td>
<td>96.462</td>
<td>50.400</td>
<td>2131.968</td>
<td>2.870</td>
<td>582677.062</td>
<td>758821.938</td>
<td>...</td>
<td>0.526</td>
<td>-0.518</td>
<td>-0.057</td>
<td>0.348</td>
<td>0.399</td>
<td>0.245</td>
<td>0.696</td>
<td>0.677</td>
<td>0.250</td>
<td>NaN</td>
</tr>
</tbody>
</table>

<p>1260 rows × 50 columns</p>
</div>
</div>
</div>
</section>
<section id="应用方法application-methods" class="level3">
<h3 class="anchored" data-anchor-id="应用方法application-methods">应用方法（Application Methods）</h3>
<p>apply() 方法是最通用的方法，它允许你对每个组应用任何自定义函数。这个函数可以执行聚合、转换或过滤操作，或者任何更复杂的逻辑。</p>
<ul>
<li>apply(func): 将一个自定义函数应用于每个组。函数的返回值可以是 Series、DataFrame 或标量。</li>
</ul>



</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-feenstra2015next" class="csl-entry" role="listitem">
Feenstra, Robert C, Robert Inklaar, and Marcel P Timmer. 2015. <span>“The Next Generation of the Penn World Table.”</span> <em>American Economic Review</em> 105 (10): 3150–82.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright © 2025 YuMingchao</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Powered by Quarto</p>
</div>
  </div>
</footer>




</body></html>